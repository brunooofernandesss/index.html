<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulado Módulo I - Potencial Elétrico da Membrana Celular</title>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        background-color: #f4f4f4;
      }

      .quiz-container {
        max-width: 800px;
        width: 100%;
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .card {
        background-color: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .question {
        font-weight: bold;
        margin-bottom: 10px;
        color: #333;
      }

      .options {
        margin-top: 15px;
      }

      .option {
        display: flex; /* Para alinhar imagem e texto */
        align-items: center;
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        position: relative; /* Para posicionar a tesoura */
      }

      .option:hover {
        background-color: #e9e9e9;
      }

      .option.selected {
        background-color: #d1e7dd;
        border-color: #28a745;
      }

      .option.correct {
        background-color: #d4edda;
        border-color: #28a745;
      }

      .option.incorrect {
        background-color: #f8d7da;
        border-color: #dc3545;
      }

      .submit-btn {
        display: block;
        width: 100%;
        padding: 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 18px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin-top: 30px;
      }

      .submit-btn:hover {
        background-color: #0056b3;
      }

      .results {
        text-align: center;
        margin-top: 30px;
        font-size: 20px;
        font-weight: bold;
        color: #333;
      }

      .scissor-icon {
        margin-right: 10px; /* Espaço entre a tesoura e o texto da opção */
        width: 20px; /* Ajuste conforme o tamanho da sua imagem */
        height: 20px; /* Ajuste conforme o tamanho da sua imagem */
        opacity: 0.5; /* Transparência como no original */
        cursor: pointer;
      }

      .scissor-icon.hidden {
        display: none;
      }

      .struck-through {
        text-decoration: line-through;
        color: #888;
      }

      .comment {
        margin-top: 10px;
        padding: 10px;
        background-color: #f0f0f0;
        border-left: 4px solid #007bff;
        font-style: italic;
        color: #555;
        display: none; /* Escondido por padrão */
      }
      .comment.show {
        display: block; /* Mostrado quando ativado */
      }

      /* Estilos para o botão de navegação de erro / diagnóstico */
      .error-nav-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #dc3545; /* Vermelho para erro */
        color: white;
        border: none;
        border-radius: 50%; /* Torna o botão redondo */
        width: 60px;
        height: 60px;
        font-size: 24px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: none; /* Escondido por padrão */
        flex-direction: column; /* Para empilhar o ícone e o contador */
        padding: 5px; /* Ajuste o padding para acomodar texto maior */
        box-sizing: border-box; /* Garante que padding não aumente o tamanho total */
        text-align: center;
      }

      .error-nav-btn:hover {
        background-color: #c82333;
      }

      .error-nav-btn .arrow-icon {
        font-size: 30px; /* Tamanho da seta */
        line-height: 1; /* Ajuste para centralizar */
      }

      .error-nav-btn .button-text {
        font-size: 12px; /* Tamanho do texto abaixo da seta */
        line-height: 1;
        margin-top: 2px; /* Espaço entre a seta e o texto */
      }
      
      /* Estilos para a seção de diagnóstico de erros */
      .error-diagnosis-section {
          margin-top: 50px;
          padding: 30px;
          background-color: #ffe0b2; /* Um laranja claro ou similar */
          border-radius: 8px;
          box-shadow: 0 2px 5px rgba(0,0,0,0.15);
          display: none; /* Escondido por padrão */
          text-align: center;
          font-size: 1.1em;
          color: #333;
      }

      .error-diagnosis-section h2 {
          color: #e65100; /* Laranja mais escuro */
          margin-bottom: 20px;
          font-size: 1.8em;
      }

      .error-diagnosis-section ul {
          list-style: none; /* Remove marcadores de lista */
          padding: 0;
          margin: 0;
      }

      .error-diagnosis-section li {
          background-color: #ff9800; /* Laranja */
          color: white;
          padding: 8px 15px;
          margin: 8px 0;
          border-radius: 5px;
          display: inline-block; /* Para que os itens fiquem lado a lado */
          margin-right: 10px;
          font-weight: bold;
      }
      .error-diagnosis-section li:last-child {
          margin-right: 0;
      }
    </style>
  </head>
  <body>
    <div class="quiz-container">
      <h1>Questionário de Múltipla Escolha: Potencial Elétrico da Membrana Celular</h1>
      <div id="quiz"></div>
      <button class="submit-btn" id="submit">Verificar Respostas</button>
      <div id="results" class="results"></div>

      <div id="errorDiagnosis" class="error-diagnosis-section">
        <h2>Diagnóstico de Erros</h2>
        <p>Parece que você precisa revisar os seguintes assuntos:</p>
        <ul id="topicsToReview">
          </ul>
      </div>
    </div>

    <button class="error-nav-btn" id="errorNavBtn">
      <span class="arrow-icon"></span> <span class="button-text"></span> </button>

    <script>
      const quizContainer = document.getElementById("quiz");
      const submitButton = document.getElementById("submit");
      const resultsContainer = document.getElementById("results");
      const errorNavBtn = document.getElementById("errorNavBtn");
      const arrowIcon = errorNavBtn.querySelector(".arrow-icon");
      const buttonText = errorNavBtn.querySelector(".button-text");
      const errorDiagnosisSection = document.getElementById("errorDiagnosis");
      const topicsToReviewList = document.getElementById("topicsToReview");

      let wrongQuestionIndices = []; // Array para armazenar os índices das questões marcadas erradas
      let errorCountByTopic = {}; // Objeto para contar erros por tópico (APENAS QUESTÕES MARCADAS ERRADO)
      let totalAnsweredQuestionsByTopic = {}; // Objeto para contar o total de questões RESPONDIDAS por tópico
      let currentWrongQuestionIndex = -1; 
      let hasErrors = false; 
      let isShowingErrors = false; // Flag para controlar se estamos navegando nos erros
      let isShowingDiagnosis = false; // Flag para controlar se estamos na seção de diagnóstico

      const questions = [
        {
          question:
            "1. Qual o principal fator que provoca a alteração no potencial elétrico da membrana celular?",
          options: [
            "a) O movimento de proteínas através da membrana.",
            "b) A síntese de ATP no citoplasma.",
            "c) O movimento de íons carregados através da membrana plasmática.",
            "d) A replicação do DNA no núcleo.",
          ],
          correctAnswer: "c) O movimento de íons carregados através da membrana plasmática.",
          comment:
            "O potencial elétrico da membrana é fundamentalmente determinado pela distribuição desigual de cargas elétricas (íons) através da bicamada lipídica. O movimento desses íons, seja para dentro ou para fora da célula, altera o balanço de cargas e, consequentemente, o potencial elétrico.",
          topic: "Conceito Básico de Potencial de Membrana",
        },
        {
          question:
            "2. No estado de repouso, como se compara o potencial elétrico do interior da célula em relação ao exterior?",
          options: [
            "a) Mais positivo.",
            "b) Neutro.",
            "c) Mais negativo.",
            "d) Igual.",
          ],
          correctAnswer: "c) Mais negativo.",
          comment:
            "O potencial de membrana em repouso (ou potencial de repouso) é caracterizado por um interior celular mais negativo em comparação com o exterior. Isso é estabelecido e mantido por gradientes de concentração de íons e pela ação da bomba de sódio e potássio, bem como pela permeabilidade seletiva da membrana a diferentes íons, principalmente ao potássio.",
          topic: "Potencial de Repouso",
        },
        {
          question:
            "3. Qual o íon que está em maior concentração fora da célula e é crucial para a despolarização?",
          options: [
            "a) $\\text{K}^{+}$ (Potássio).",
            "b) $\\text{Cl}^{-}$ (Cloreto).",
            "c) $\\text{Na}^{+}$ (Sódio).",
            "d) $\\text{Ca}^{2+}$ (Cálcio).",
          ],
          correctAnswer: "c) $\\text{Na}^{+}$ (Sódio).",
          comment:
            "O íon $\\text{Na}^{+}$ (Sódio) é encontrado em alta concentração no meio extracelular. Sua entrada rápida na célula através de canais iônicos específicos é a principal responsável pela despolarização da membrana durante um potencial de ação.",
          topic: "Distribuição Iônica: Sódio",
        },
        {
          question:
            "4. A bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase é fundamental para o potencial de repouso porque:",
          options: [
            "a) Transporta $\\text{K}^{+}$ para fora e $\\text{Na}^{+}$ para dentro da célula.",
            "b) Transporta $\\text{Na}^{+}$ para fora e $\\text{K}^{+}$ para dentro da célula.",
            "c) Transporta ambos os íons para fora da célula.",
            "d) Transporta ambos os íons para dentro da célula.",
          ],
          correctAnswer: "b) Transporta $\\text{Na}^{+}$ para fora e $\\text{K}^{+}$ para dentro da célula.",
          comment:
            "A bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase é uma proteína de transporte ativo que bombeia 3 íons $\\text{Na}^{+}$ para fora da célula e 2 íons $\\text{K}^{+}$ para dentro da célula a cada ciclo, utilizando ATP. Isso contribui diretamente para a manutenção dos gradientes de concentração de $\\text{Na}^{+}$ e $\\text{K}^{+}$ e para o estabelecimento do potencial de membrana em repouso, ao criar um leve excesso de cargas positivas fora da célula.",
          topic: "Bomba de Sódio e Potássio",
        },
        {
          question:
            "5. O que acontece com o potencial de membrana durante a despolarização?",
          options: [
            "a) Torna-se mais negativo.",
            "b) Torna-se menos negativo (mais positivo).",
            "c) Permanece inalterado.",
            "d) Retorna ao seu estado de repouso.",
          ],
          correctAnswer: "b) Torna-se menos negativo (mais positivo).",
          comment:
            "A despolarização é o processo em que o potencial de membrana se move para valores menos negativos, ou seja, em direção a zero ou a valores positivos. Isso geralmente ocorre devido à entrada de íons positivos (como $\\text{Na}^{+}$) na célula.",
          topic: "Despolarização",
        },
        {
          question:
            "6. A repolarização de uma membrana celular ocorre devido principalmente à:",
          options: [
            "a) Entrada de $\\text{Na}^{+}$.",
            "b) Saída de $\\text{K}^{+}$.",
            "c) Saída de $\\text{Cl}^{-}$.",
            "d) Entrada de $\\text{Ca}^{2+}$.",
          ],
          correctAnswer: "b) Saída de $\\text{K}^{+}$.",
          comment:
            "Após a despolarização, a repolarização (retorno ao potencial de repouso) é predominantemente causada pela abertura de canais de $\\text{K}^{+}$ dependentes de voltagem, que permitem a saída de íons $\\text{K}^{+}$ (cargas positivas) do interior da célula, tornando o potencial de membrana mais negativo novamente.",
          topic: "Repolarização",
        },
        {
          question: "7. O que é a hiperpolarização?",
          options: [
            "a) O potencial de membrana se torna mais positivo que o potencial de repouso.",
            "b) O potencial de membrana se torna mais negativo que o potencial de repouso.",
            "c) O potencial de membrana atinge o limiar para um potencial de ação.",
            "d) O potencial de membrana permanece em repouso.",
          ],
          correctAnswer: "b) O potencial de membrana se torna mais negativo que o potencial de repouso.",
          comment:
            "A hiperpolarização é um estado em que o potencial de membrana se torna ainda mais negativo do que o potencial de repouso normal. Isso pode ocorrer devido à saída de cargas positivas (como $\\text{K}^{+}$) ou à entrada de cargas negativas (como $\\text{Cl}^{-}$).",
          topic: "Hiperpolarização",
        },
        {
          question:
            "8. O que é um canal iônico regulado por voltagem?",
          options: [
            "a) Um canal que abre em resposta à ligação de uma molécula sinalizadora.",
            "b) Um canal que abre em resposta a uma mudança no potencial elétrico da membrana.",
            "c) Um canal que está sempre aberto.",
            "d) Um canal que transporta íons contra seu gradiente de concentração.",
          ],
          correctAnswer: "b) Um canal que abre em resposta a uma mudança no potencial elétrico da membrana.",
          comment:
            "Canais iônicos regulados por voltagem são proteínas transmembrana que alteram sua conformação (abrem ou fecham) em resposta a variações no potencial elétrico através da membrana celular. Eles são cruciais para a geração e propagação de potenciais de ação.",
          topic: "Canais Iônicos Voltagem-Dependentes",
        },
        {
          question:
            "9. A fase de 'limiar' em um potencial de ação refere-se ao:",
          options: [
            "a) Potencial máximo atingido pela despolarização.",
            "b) Potencial mínimo necessário para disparar um potencial de ação.",
            "c) Potencial de repouso da célula.",
            "d) Potencial durante a repolarização.",
          ],
          correctAnswer: "b) Potencial mínimo necessário para disparar um potencial de ação.",
          comment:
            "O limiar é o potencial de membrana crítico que deve ser atingido para que um potencial de ação seja disparado. Se o estímulo não atingir esse limiar, nenhum potencial de ação completo será gerado, e a célula retornará ao repouso.",
          topic: "Limiar do Potencial de Ação",
        },
        {
          question:
            "10. Qual a principal característica de um potencial de ação de 'tudo ou nada'?",
          options: [
            "a) Sua amplitude varia com a intensidade do estímulo.",
            "b) Ele ocorre com amplitude máxima se o limiar for atingido, ou não ocorre.",
            "c) Ele pode ser interrompido a qualquer momento.",
            "d) Depende da quantidade de proteínas no citoplasma.",
          ],
          correctAnswer: "b) Ele ocorre com amplitude máxima se o limiar for atingido, ou não ocorre.",
          comment:
            "O princípio de 'tudo ou nada' significa que, uma vez que o limiar é alcançado, o potencial de ação é disparado com sua amplitude e duração características, independentemente da intensidade do estímulo que o iniciou (desde que o estímulo seja supra-limiar). Se o limiar não for atingido, nenhum potencial de ação ocorre.",
          topic: "Princípio do Tudo ou Nada",
        },
        {
          question:
            "11. Qual é o papel dos canais de vazamento de $\\text{K}^{+}$ no potencial de repouso?",
          options: [
            "a) Eles iniciam a despolarização.",
            "b) Eles permitem a saída contínua de $\\text{K}^{+}$, contribuindo para a negatividade interna.",
            "c) Eles bloqueiam a passagem de $\\text{K}^{+}$.",
            "d) Eles transportam $\\text{K}^{+}$ ativamente para dentro da célula.",
          ],
          correctAnswer: "b) Eles permitem a saída contínua de $\\text{K}^{+}$, contribuindo para a negatividade interna.",
          comment:
            "Os canais de vazamento de $\\text{K}^{+}$ (ou canais de repouso de $\\text{K}^{+}$) são canais iônicos que estão abertos no potencial de repouso, permitindo que os íons $\\text{K}^{+}$ se movam para fora da célula a favor de seu gradiente de concentração. Essa saída contínua de cargas positivas é um dos principais fatores que estabelecem e mantêm a negatividade do potencial de repouso.",
          topic: "Canais de Vazamento de Potássio",
        },
        {
          question:
            "12. Em que tipo de células os potenciais de ação são mais frequentemente observados e são cruciais para sua função?",
          options: [
            "a) Células epiteliais.",
            "b) Células adiposas.",
            "c) Células excitáveis (neurônios e células musculares).",
            "d) Células sanguíneas.",
          ],
          correctAnswer: "c) Células excitáveis (neurônios e células musculares).",
          comment:
            "Potenciais de ação são os sinais elétricos fundamentais utilizados por células excitáveis, como neurônios (para transmitir informações) e células musculares (para iniciar a contração).",
          topic: "Células Excitáveis",
        },
        {
          question:
            "13. A fase de queda rápida do potencial de ação (repolarização) é principalmente causada pela:",
          options: [
            "a) Abertura de canais de $\\text{Na}^{+}$ dependentes de voltagem.",
            "b) Fechamento de canais de $\\text{K}^{+}$ dependentes de voltagem.",
            "c) Inativação dos canais de $\\text{Na}^{+}$ dependentes de voltagem e abertura dos canais de $\\text{K}^{+}$ dependentes de voltagem.",
            "d) Atividade da bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase.",
          ],
          correctAnswer: "c) Inativação dos canais de $\\text{Na}^{+}$ dependentes de voltagem e abertura dos canais de $\\text{K}^{+}$ dependentes de voltagem.",
          comment:
            "A repolarização ocorre devido a dois eventos coordenados: a rápida inativação dos canais de $\\text{Na}^{+}$ dependentes de voltagem (impedindo a entrada de $\\text{Na}^{+}$) e a abertura mais lenta dos canais de $\\text{K}^{+}$ dependentes de voltagem (permitindo a saída de $\\text{K}^{+}$), o que restaura a negatividade do potencial de membrana.",
          topic: "Eventos Iônicos da Repolarização",
        },
        {
          question:
            "14. O que é o período refratário absoluto de um neurônio?",
          options: [
            "a) O período em que um segundo potencial de ação pode ser gerado com um estímulo mais forte.",
            "b) O período em que nenhum segundo potencial de ação pode ser gerado, independentemente da intensidade do estímulo.",
            "c) O período em que a célula está em hiperpolarização.",
            "d) O período em que os canais de $\\text{K}^{+}$ estão fechados.",
          ],
          correctAnswer: "b) O período em que nenhum segundo potencial de ação pode ser gerado, independentemente da intensidade do estímulo.",
          comment:
            "Durante o período refratário absoluto, os canais de $\\text{Na}^{+}$ dependentes de voltagem estão inativados, impedindo a geração de um novo potencial de ação, mesmo com um estímulo muito forte. Isso garante a propagação unidirecional dos potenciais de ação.",
          topic: "Período Refratário Absoluto",
        },
        {
          question:
            "15. O potencial de equilíbrio de um íon é o potencial de membrana no qual:",
          options: [
            "a) O íon para de se mover através da membrana.",
            "b) A força elétrica e a força do gradiente de concentração sobre o íon são iguais e opostas, resultando em nenhum movimento líquido.",
            "c) O íon se move apenas por transporte ativo.",
            "d) A célula morre.",
          ],
          correctAnswer: "b) A força elétrica e a força do gradiente de concentração sobre o íon são iguais e opostas, resultando em nenhum movimento líquido.",
          comment:
            "O potencial de equilíbrio de um íon é o potencial elétrico transmembrana no qual a força química (gradiente de concentração) que impulsiona o íon em uma direção é exatamente balanceada pela força elétrica que o impulsiona na direção oposta, resultando em um fluxo líquido zero do íon através da membrana.",
          topic: "Potencial de Equilíbrio Iônico",
        },
        {
          question:
            "16. Para qual íon o potencial de membrana em repouso é mais próximo de seu potencial de equilíbrio?",
          options: [
            "a) $\\text{Na}^{+}$",
            "b) $\\text{Ca}^{2+}$",
            "c) $\\text{K}^{+}$",
            "d) $\\text{Cl}^{-}$",
          ],
          correctAnswer: "c) $\\text{K}^{+}$",
          comment:
            "O potencial de membrana em repouso é primariamente determinado pela permeabilidade seletiva da membrana aos íons $\\text{K}^{+}$ (via canais de vazamento de $\\text{K}^{+}$), o que torna o potencial de repouso muito próximo do potencial de equilíbrio de $\\text{K}^{+}$ (aproximadamente -90 mV), que é o mais negativo.",
          topic: "Potencial de Repouso e Potencial de Equilíbrio",
        },
        {
          question: "17. O que é um potencial graduado?",
          options: [
            "a) Um potencial de ação que viaja longas distâncias.",
            "b) Uma alteração no potencial de membrana cuja amplitude varia com a intensidade do estímulo.",
            "c) Um potencial que segue o princípio de 'tudo ou nada'.",
            "d) Um potencial que ocorre apenas em células não excitáveis.",
          ],
          correctAnswer: "b) Uma alteração no potencial de membrana cuja amplitude varia com a intensidade do estímulo.",
          comment:
            "Potenciais graduados (ou locais) são alterações temporárias no potencial de membrana cuja magnitude é proporcional à intensidade do estímulo. Diferentemente dos potenciais de ação, eles não são de 'tudo ou nada' e sua amplitude diminui com a distância.",
          topic: "Potenciais Graduados",
        },
        {
          question:
            "18. Qual o efeito de um aumento na permeabilidade da membrana ao $\\text{Na}^{+}$?",
          options: [
            "a) Hiperpolarização.",
            "b) Repolarização.",
            "c) Despolarização.",
            "d) Nenhuma alteração.",
          ],
          correctAnswer: "c) Despolarização.",
          comment:
            "Um aumento na permeabilidade ao $\\text{Na}^{+}$ permite que mais íons $\\text{Na}^{+}$ (carregados positivamente e mais concentrados fora da célula) entrem na célula, tornando o interior menos negativo e, portanto, despolarizando a membrana.",
          topic: "Efeito da Permeabilidade ao Sódio",
        },
        {
          question:
            "19. A mielinização de um axônio acelera a condução do potencial de ação através de um processo chamado:",
          options: [
            "a) Condução contínua.",
            "b) Condução saltatória.",
            "c) Potencial graduado.",
            "d) Repolarização.",
          ],
          correctAnswer: "b) Condução saltatória.",
          comment:
            "A bainha de mielina isola o axônio, e o potencial de ação salta de um Nodo de Ranvier (regiões não mielinizadas) para o próximo, um processo conhecido como condução saltatória. Isso aumenta drasticamente a velocidade de condução do impulso nervoso.",
          topic: "Mielinização e Condução Saltatória",
        },
        {
          question: "20. Os Nodos de Ranvier são importantes porque:",
          options: [
            "a) São as únicas regiões do axônio onde o potencial de ação pode ser gerado.",
            "b) São as regiões do axônio cobertas por mielina.",
            "c) São as regiões onde a bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase está ausente.",
            "d) São os terminais sinápticos.",
          ],
          correctAnswer: "a) São as únicas regiões do axônio onde o potencial de ação pode ser gerado.",
          comment:
            "Nos axônios mielinizados, os canais de $\\text{Na}^{+}$ dependentes de voltagem estão concentrados nos Nodos de Ranvier. O potencial de ação é regenerado nesses nós, permitindo a condução saltatória e a rápida propagação do sinal.",
          topic: "Nodos de Ranvier",
        },
        {
          question:
            "21. Qual o papel da bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase no retorno ao potencial de repouso após um potencial de ação prolongado ou repetitivo?",
          options: [
            "a) Ela inicia a despolarização.",
            "b) Ela restabelece os gradientes de concentração de $\\text{Na}^{+}$ e $\\text{K}^{+}$ que foram ligeiramente alterados.",
            "c) Ela impede a repolarização.",
            "d) Ela é responsável pela fase de pico do potencial de ação.",
          ],
          correctAnswer: "b) Ela restabelece os gradientes de concentração de $\\text{Na}^{+}$ e $\\text{K}^{+}$ que foram ligeiramente alterados.",
          comment:
            "Embora a repolarização primária seja devido ao movimento iônico através dos canais de $\\text{Na}^{+}$ e $\\text{K}^{+}$, a bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase trabalha continuamente para restabelecer os gradientes de concentração de $\\text{Na}^{+}$ e $\\text{K}^{+}$ que são ligeiramente dissipados durante a sequência de múltiplos potenciais de ação. Ela é essencial para a manutenção a longo prazo do potencial de repouso e da excitabilidade celular.",
          topic: "Função da Bomba de Sódio e Potássio no Potencial de Ação",
        },
        {
          question:
            "22. Se a concentração de $\\text{K}^{+}$ extracelular aumentar, o que acontecerá com o potencial de membrana em repouso da célula?",
          options: [
            "a) Torna-se mais negativo (hiperpolarização).",
            "b) Torna-se menos negativo (despolarização).",
            "c) Não se altera.",
            "d) Torna-se neutro.",
          ],
          correctAnswer: "b) Torna-se menos negativo (despolarização).",
          comment:
            "Um aumento na concentração de $\\text{K}^{+}$ extracelular reduz o gradiente de concentração de $\\text{K}^{+}$ para fora da célula. Isso faz com que menos $\\text{K}^{+}$ saia pelos canais de vazamento, tornando o interior da célula menos negativo e despolarizando-a. Isso pode ser muito perigoso para a função cardíaca e nervosa.",
          topic: "Efeito da Concentração de Potássio Extracelular",
        },
        {
          question:
            "23. Qual o principal íon responsável pela fase de ascendência (despolarização) do potencial de ação?",
          options: [
            "a) $\\text{K}^{+}$",
            "b) $\\text{Cl}^{-}$",
            "c) $\\text{Na}^{+}$",
            "d) $\\text{Ca}^{2+}$",
          ],
          correctAnswer: "c) $\\text{Na}^{+}$",
          comment:
            "A fase ascendente do potencial de ação é caracterizada por uma rápida despolarização causada pela abertura de canais de $\\text{Na}^{+}$ dependentes de voltagem e a consequente entrada massiva de íons $\\text{Na}^{+}$ na célula.",
          topic: "Íons na Despolarização do Potencial de Ação",
        },
        {
          question:
            "24. Os anestésicos locais funcionam bloqueando quais canais iônicos?",
          options: [
            "a) Canais de $\\text{K}^{+}$ dependentes de voltagem.",
            "b) Canais de $\\text{Na}^{+}$ dependentes de voltagem.",
            "c) Canais de $\\text{Ca}^{2+}$ dependentes de voltagem.",
            "d) Canais de $\\text{Cl}^{-}$ regulados por ligante.",
          ],
          correctAnswer: "b) Canais de $\\text{Na}^{+}$ dependentes de voltagem.",
          comment:
            "Os anestésicos locais exercem seu efeito ao bloquear a abertura dos canais de $\\text{Na}^{+}$ dependentes de voltagem nos neurônios. Ao impedir a entrada de $\\text{Na}^{+}$, eles inibem a geração e a propagação dos potenciais de ação, bloqueando a transmissão da dor.",
          topic: "Mecanismo de Ação de Anestésicos Locais",
        },
        {
          question:
            "25. O que define o período refratário relativo?",
          options: [
            "a) Nenhum potencial de ação pode ser gerado.",
            "b) Um segundo potencial de ação pode ser gerado, mas apenas com um estímulo supra-limiar (mais forte).",
            "c) A célula está em repouso.",
            "d) Ocorre a repolarização completa.",
          ],
          correctAnswer: "b) Um segundo potencial de ação pode ser gerado, mas apenas com um estímulo supra-limiar (mais forte).",
          comment:
            "O período refratário relativo ocorre logo após o período refratário absoluto, durante a fase de repolarização e, às vezes, hiperpolarização. Durante este período, alguns canais de $\\text{Na}^{+}$ se recuperaram da inativação, mas a célula está mais negativa ou os canais de $\\text{K}^{+}$ ainda estão abertos, exigindo um estímulo mais forte para atingir o limiar e disparar um novo potencial de ação.",
          topic: "Período Refratário Relativo",
        },
        {
          question:
            "26. Como a distribuição de íons $\\text{Cl}^{-}$ contribui para o potencial de membrana em repouso?",
          options: [
            "a) $\\text{Cl}^{-}$ é ativamente bombeado para fora da célula.",
            "b) A alta concentração de $\\text{Cl}^{-}$ fora da célula e a sua permeabilidade contribuem para a negatividade interna.",
            "c) $\\text{Cl}^{-}$ é o principal íon a despolarizar a membrana.",
            "d) $\\text{Cl}^{-}$ não tem papel no potencial de repouso.",
          ],
          correctAnswer: "b) A alta concentração de $\\text{Cl}^{-}$ fora da célula e a sua permeabilidade contribuem para a negatividade interna.",
          comment:
            "Os íons $\\text{Cl}^{-}$ estão em maior concentração fora da célula. A membrana é relativamente permeável ao $\\text{Cl}^{-}$ em repouso, e sua tendência de entrar na célula a favor de seu gradiente de concentração eletroquímico contribui para a negatividade do potencial de repouso, embora em menor grau que a saída de $\\text{K}^{+}$.",
          topic: "Contribuição do Cloreto ao Potencial de Repouso",
        },
        {
          question:
            "27. Qual o papel dos canais de $\\text{Ca}^{2+}$ dependentes de voltagem nos terminais axônicos?",
          options: [
            "a) Iniciar a repolarização.",
            "b) Liberar neurotransmissores.",
            "c) Manter o potencial de repouso.",
            "d) Bloquear a propagação do potencial de ação.",
          ],
          correctAnswer: "b) Liberar neurotransmissores.",
          comment:
            "A chegada de um potencial de ação ao terminal axônico despolariza a membrana e abre os canais de $\\text{Ca}^{2+}$ dependentes de voltagem. A entrada de $\\text{Ca}^{2+}$ no terminal aciona a fusão de vesículas sinápticas com a membrana pré-sináptica, liberando neurotransmissores na fenda sináptica.",
          topic: "Canais de Cálcio e Liberação de Neurotransmissores",
        },
        {
          question: "28. O que é um neurotransmissor excitatório?",
          options: [
            "a) Uma substância que causa hiperpolarização da membrana pós-sináptica.",
            "b) Uma substância que causa despolarização da membrana pós-sináptica, aproximando-a do limiar.",
            "c) Uma substância que inibe a transmissão do sinal.",
            "d) Uma substância que não altera o potencial de membrana.",
          ],
          correctAnswer: "b) Uma substância que causa despolarização da membrana pós-sináptica, aproximando-a do limiar.",
          comment:
            "Neurotransmissores excitatórios (como o glutamato ou a acetilcolina em junções neuromusculares) ligam-se a receptores na membrana pós-sináptica, causando a abertura de canais iônicos que permitem a entrada de cargas positivas (ex: $\\text{Na}^{+}$), levando à despolarização (potencial pós-sináptico excitatório - PPSE) e aumentando a probabilidade de um potencial de ação.",
          topic: "Neurotransmissores Excitatórios",
        },
        {
          question: "29. O que é um neurotransmissor inibitório?",
          options: [
            "a) Uma substância que causa despolarização da membrana pós-sináptica.",
            "b) Uma substância que causa hiperpolarização da membrana pós-sináptica ou a estabiliza perto do potencial de repouso, afastando-a do limiar.",
            "c) Uma substância que acelera a transmissão do sinal.",
            "d) Uma substância que é liberada apenas em células musculares.",
          ],
          correctAnswer: "b) Uma substância que causa hiperpolarização da membrana pós-sináptica ou a estabiliza perto do potencial de repouso, afastando-a do limiar.",
          comment:
            "Neurotransmissores inibitórios (como GABA ou glicina) ligam-se a receptores na membrana pós-sináptica, causando a abertura de canais iônicos que permitem a entrada de cargas negativas (ex: $\\text{Cl}^{-}$) ou a saída de cargas positivas (ex: $\\text{K}^{+}$), levando à hiperpolarização (potencial pós-sináptico inibitório - PPSI) ou estabilização da membrana, diminuindo a probabilidade de um potencial de ação.",
          topic: "Neurotransmissores Inibitórios",
        },
        {
          question:
            "30. A Lei de Ohm, no contexto da bioeletricidade, expressa a relação entre:",
          options: [
            "a) Pressão, volume e temperatura.",
            "b) Corrente, voltagem e resistência.",
            "c) Massa, aceleração e força.",
            "d) Densidade, massa e volume.",
          ],
          correctAnswer: "b) Corrente, voltagem e resistência.",
          comment:
            "A Lei de Ohm (V = I x R, ou I = V/R) é fundamental na biofísica das membranas. Ela relaciona a voltagem (V, potencial de membrana), a corrente (I, fluxo de íons) e a resistência (R, a oposição ao fluxo de íons através da membrana). Entender essa relação é essencial para compreender como os íons se movem e alteram o potencial.",
          topic: "Lei de Ohm em Bioeletricidade",
        },
        {
          question:
            "31. O potencial de Nernst para um íon é calculado usando qual equação?",
          options: [
            "a) Equação de Goldman.",
            "b) Equação de Nernst.",
            "c) Equação de Planck.",
            "d) Equação de Einstein.",
          ],
          correctAnswer: "b) Equação de Nernst.",
          comment:
            "A Equação de Nernst é utilizada para calcular o potencial de equilíbrio de um único íon através de uma membrana semipermeável, levando em conta sua concentração intra e extracelular e sua carga elétrica.",
          topic: "Equação de Nernst",
        },
        {
          question:
            "32. Qual a relação entre a permeabilidade da membrana a diferentes íons e o potencial de membrana em repouso?",
          options: [
            "a) A permeabilidade só afeta a despolarização.",
            "b) O potencial de repouso é mais influenciado pelos íons para os quais a membrana é mais permeável.",
            "c) A permeabilidade não tem relação com o potencial de repouso.",
            "d) A membrana é igualmente permeável a todos os íons em repouso.",
          ],
          correctAnswer: "b) O potencial de repouso é mais influenciado pelos íons para os quais a membrana é mais permeável.",
          comment:
            "O potencial de membrana em repouso é um potencial de difusão que é fortemente influenciado pela permeabilidade relativa da membrana a diferentes íons. Como a membrana em repouso é muito mais permeável ao $\\text{K}^{+}$ (devido aos canais de vazamento de $\\text{K}^{+}$) do que ao $\\text{Na}^{+}$, o potencial de repouso é mais próximo do potencial de equilíbrio de $\\text{K}^{+}$.",
          topic: "Permeabilidade Iônica e Potencial de Repouso",
        },
        {
          question:
            "33. Quais os dois principais tipos de canais iônicos envolvidos na geração e propagação do potencial de ação?",
          options: [
            "a) Canais de vazamento de $\\text{K}^{+}$ e canais de $\\text{Cl}^{-}$ regulados por voltagem.",
            "b) Canais de $\\text{Na}^{+}$ dependentes de voltagem e canais de $\\text{K}^{+}$ dependentes de voltagem.",
            "c) Canais de $\\text{Ca}^{2+}$ ativados por ligante e canais de $\\text{Na}^{+}$ de vazamento.",
            "d) Bombas de íons e transportadores.",
          ],
          correctAnswer: "b) Canais de $\\text{Na}^{+}$ dependentes de voltagem e canais de $\\text{K}^{+}$ dependentes de voltagem.",
          comment:
            "Os canais de $\\text{Na}^{+}$ dependentes de voltagem (responsáveis pela despolarização inicial) e os canais de $\\text{K}^{+}$ dependentes de voltagem (responsáveis pela repolarização) são os principais atores na geração e propagação dos potenciais de ação.",
          topic: "Canais Iônicos no Potencial de Ação",
        },
        {
          question:
            "34. Por que a propagação do potencial de ação é unidirecional na maioria dos axônios?",
          options: [
            "a) Devido à presença de canais de $\\text{Ca}^{2+}$.",
            "b) Devido ao período refratário dos canais de $\\text{Na}^{+}$ ativados.",
            "c) Devido à ausência de $\\text{K}^{+}$ na célula.",
            "d) Devido à mielinização completa do axônio.",
          ],
          correctAnswer: "b) Devido ao período refratário dos canais de $\\text{Na}^{+}$ ativados.",
          comment:
            "O período refratário (especialmente o absoluto), que ocorre logo após a ativação dos canais de $\\text{Na}^{+}$, garante que a região do axônio que acabou de ser despolarizada esteja temporariamente inativa, impedindo que o potencial de ação se propague para trás e assegurando a condução unidirecional.",
          topic: "Unidirecionalidade do Potencial de Ação",
        },
        {
          question:
            "35. O que aconteceria com a excitabilidade de um neurônio se a bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase parasse de funcionar?",
          options: [
            "a) A célula se hiperpolarizaria.",
            "b) Os gradientes iônicos desapareceriam gradualmente, levando à perda do potencial de repouso e da excitabilidade.",
            "c) A célula se tornaria mais excitável.",
            "d) Não haveria alteração na excitabilidade.",
          ],
          correctAnswer: "b) Os gradientes iônicos desapareceriam gradualmente, levando à perda do potencial de repouso e da excitabilidade.",
          comment:
            "A bomba de $\\text{Na}^{+}/\\text{K}^{+}$ ATPase é vital para manter os gradientes de concentração de $\\text{Na}^{+}$ e $\\text{K}^{+}$ através da membrana. Se ela parar de funcionar, esses gradientes se dissiparão ao longo do tempo, e o potencial de membrana em repouso não poderá ser mantido, resultando na perda da capacidade da célula de gerar potenciais de ação e, consequentemente, da sua excitabilidade.",
          topic: "Importância da Bomba de Sódio e Potássio para a Excitabilidade",
        },
        {
          question:
            "36. A condução do potencial de ação em axônios não mielinizados é mais lenta porque:",
          options: [
            "a) Ocorre condução saltatória.",
            "b) O potencial de ação precisa ser regenerado em cada ponto da membrana.",
            "c) Não há canais iônicos nesses axônios.",
            "d) Ocorre maior vazamento de corrente.",
          ],
          correctAnswer: "b) O potencial de ação precisa ser regenerado em cada ponto da membrana.",
          comment:
            "Em axônios não mielinizados, o potencial de ação precisa ser regenerado continuamente em cada ponto da membrana ao longo do axônio. Isso requer a abertura sequencial de canais de $\\text{Na}^{+}$ dependentes de voltagem ao longo de todo o axônio, tornando a condução muito mais lenta do que a condução saltatória nos axônios mielinizados.",
          topic: "Condução em Axônios Não Mielinizados",
        },
        {
          question:
            "37. O que é plasticidade sináptica e como ela se relaciona com o potencial de membrana?",
          options: [
            "a) A capacidade da membrana de alterar sua forma.",
            "b) A capacidade de uma sinapse de fortalecer ou enfraquecer suas conexões ao longo do tempo, alterando a eficácia da transmissão do potencial.",
            "c) A flexibilidade da membrana plasmática para se mover.",
            "d) A resistência da membrana à passagem de íons.",
          ],
          correctAnswer: "b) A capacidade de uma sinapse de fortalecer ou enfraquecer suas conexões ao longo do tempo, alterando a eficácia da transmissão do potencial.",
          comment:
            "Plasticidade sináptica refere-se à capacidade das sinapses de mudar sua força de transmissão em resposta à atividade. Isso envolve alterações na excitabilidade pós-sináptica (influenciando a despolarização ou hiperpolarização) e na liberação de neurotransmissores, sendo fundamental para o aprendizado e a memória.",
          topic: "Plasticidade Sináptica",
        },
        {
          question:
            "38. Qual o papel dos canais de $\\text{K}^{+}$ de repouso (canais de vazamento) na manutenção do potencial de membrana em repouso?",
          options: [
            "a) Geram a despolarização.",
            "b) Permitem um efluxo constante de $\\text{K}^{+}$, contribuindo significativamente para a negatividade interna.",
            "c) Bloqueiam completamente o movimento de $\\text{K}^{+}$.",
            "d) Transportam $\\text{K}^{+}$ para dentro da célula ativamente.",
          ],
          correctAnswer: "b) Permitem um efluxo constante de $\\text{K}^{+}$, contribuindo significativamente para a negatividade interna.",
          comment:
            "Os canais de $\\text{K}^{+}$ de repouso são constitutivamente abertos no potencial de repouso. Eles permitem que os íons $\\text{K}^{+}$, que estão em maior concentração no interior da célula, vazem para fora da célula, levando cargas positivas para fora e tornando o interior da célula negativo. Esse vazamento de $\\text{K}^{+}$ é o principal determinante do potencial de membrana em repouso.",
          topic: "Canais de Potássio de Repouso",
        },
        {
          question:
            "39. Se um íon carregado positivamente entra em uma célula, o que geralmente acontece com o potencial de membrana?",
          options: [
            "a) Hiperpolarização.",
            "b) Repolarização.",
            "c) Despolarização.",
            "d) O potencial de membrana não se altera.",
          ],
          correctAnswer: "c) Despolarização.",
          comment:
            "A entrada de cargas positivas no interior da célula (que é geralmente negativo em repouso) torna o potencial de membrana menos negativo, ou seja, o despolariza, aproximando-o do zero ou tornando-o positivo.",
          topic: "Efeito da Entrada de Íons Positivos",
        },
        {
          question:
            "40. Por que a saída de íons $\\text{K}^{+}$ é tão importante para o retorno ao potencial de repouso após a despolarização?",
          options: [
            "a) $\\text{K}^{+}$ é o único íon capaz de sair da célula.",
            "b) A saída de $\\text{K}^{+}$ repõe as cargas positivas perdidas durante a despolarização.",
            "c) A saída de $\\text{K}^{+}$ (cargas positivas) torna o interior da célula mais negativo, revertendo a despolarização.",
            "d) A entrada de $\\text{K}^{+}$ causa a repolarização.",
          ],
          correctAnswer: "c) A saída de $\\text{K}^{+}$ (cargas positivas) torna o interior da célula mais negativo, revertendo a despolarização.",
          comment:
            "Durante a repolarização, os canais de sódio se inativam e os canais de potássio dependentes de voltagem se abrem, permitindo que os íons $\\text{K}^{+}$ (carregados positivamente) fluam para fora da célula. Essa saída de cargas positivas remove a positividade que se acumulou durante a despolarização, restaurando o potencial de membrana negativo.",
          topic: "Importância da Saída de Potássio na Repolarização",
        },
      ];

      function buildQuiz() {
        const output = [];

        questions.forEach((currentQuestion, questionNumber) => {
          const options = [];
          for (let i = 0; i < currentQuestion.options.length; i++) {
            options.push(
              `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                ${currentQuestion.options[i]}
              </label>`
            );
          }

          output.push(
            `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
              <div class="question">${currentQuestion.question}</div>
              <div class="options">${options.join("")}</div>
              <div class="comment" id="comment-${questionNumber}"></div>
            </div>`
          );
        });

        quizContainer.innerHTML = output.join("");
      }

      function showResults() {
        wrongQuestionIndices = []; 
        errorCountByTopic = {}; // Reseta a contagem de erros por tópico
        totalAnsweredQuestionsByTopic = {}; // Reseta a contagem de questões respondidas por tópico
        currentWrongQuestionIndex = -1; 
        hasErrors = false; 
        isShowingErrors = false; 
        isShowingDiagnosis = false;

        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = ''; 

        const answerContainers = quizContainer.querySelectorAll(".options");
        let correctAnswers = 0;

        questions.forEach((currentQuestion, questionNumber) => {
          const answerContainer = answerContainers[questionNumber];
          const userAnswerElement = answerContainer.querySelector('.option.selected');
          const userAnswerValue = userAnswerElement ? userAnswerElement.dataset.value : undefined;
          const commentDiv = document.getElementById(`comment-${questionNumber}`);

          // Limpa estados anteriores
          const allOptions = answerContainer.querySelectorAll('.option');
          allOptions.forEach(option => {
            option.classList.remove('correct', 'incorrect');
            const scissorIcon = option.querySelector('.scissor-icon');
            if (scissorIcon) scissorIcon.classList.remove('hidden');
          });
          if (commentDiv) commentDiv.classList.remove('show');


          const optionElements = answerContainer.querySelectorAll('.option');
          optionElements.forEach(option => {
            const scissorIcon = option.querySelector('.scissor-icon');

            if (option === userAnswerElement && scissorIcon) {
                scissorIcon.classList.add('hidden');
            } 
            
            if (option.dataset.value === currentQuestion.correctAnswer) {
                option.classList.add('correct');
                if (commentDiv && currentQuestion.comment) {
                    commentDiv.textContent = currentQuestion.comment;
                    commentDiv.classList.add('show');
                }
            }
          });

          // ***************************************************************
          // Lógica crucial: Apenas contabiliza se a questão foi respondida
          // ***************************************************************
          if (userAnswerElement) { // Se o usuário marcou alguma alternativa
            totalAnsweredQuestionsByTopic[currentQuestion.topic] = (totalAnsweredQuestionsByTopic[currentQuestion.topic] || 0) + 1;

            if (userAnswerValue !== currentQuestion.correctAnswer) {
              userAnswerElement.classList.add('incorrect');
              wrongQuestionIndices.push(questionNumber);
              hasErrors = true; 

              // Incrementa o contador de erros para este tópico
              errorCountByTopic[currentQuestion.topic] = (errorCountByTopic[currentQuestion.topic] || 0) + 1;
            } else {
              correctAnswers++;
            }
          }
          // ***************************************************************
          // Fim da lógica crucial
          // ***************************************************************
        });

        resultsContainer.textContent = `Você acertou ${correctAnswers} de ${questions.length} questões.`;
        
        // Rola a página totalmente para baixo para exibir o resultado
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

        if (hasErrors) {
            errorNavBtn.style.display = 'flex';
            arrowIcon.textContent = '⬆️'; // Seta para cima inicialmente
            buttonText.textContent = 'Diagnóstico de Erros'; // Texto claro para diagnóstico
            isShowingErrors = false; // Não estamos navegando erro a erro inicialmente
            isShowingDiagnosis = false; // Ainda não mostramos o diagnóstico
        } else {
            errorNavBtn.style.display = 'none';
        }
      }

      function scrollToQuestion(index) {
        const questionCard = document.getElementById(`question-${index}`);
        if (questionCard) {
          questionCard.scrollIntoView({ behavior: 'smooth', block: 'center' }); 
        }
      }
      
      function scrollToDiagnosis() {
          errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      quizContainer.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');

        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                optionElement.classList.toggle("struck-through");
            } 
            else {
                const questionNumber = optionElement.dataset.question;
                const currentQuestionOptions = quizContainer.querySelectorAll(`.option[data-question=\"${questionNumber}\"]`);
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                
                optionElement.classList.add("selected");
            }
        }
      });

      errorNavBtn.addEventListener("click", function() {
        if (!hasErrors) { // Se não há erros, o botão não deveria estar visível, mas por segurança
            errorNavBtn.style.display = 'none';
            return;
        }

        if (!isShowingErrors && !isShowingDiagnosis) { 
            // Clicou no botão "Diagnóstico de Erros" (seta para cima) para iniciar a navegação ou ir para o diagnóstico
            if (wrongQuestionIndices.length > 0) {
                isShowingErrors = true; // Inicia o modo de navegação de erros
                currentWrongQuestionIndex = 0; // Começa pelo primeiro erro
                arrowIcon.textContent = '⬇️'; // Muda a seta para baixo para navegar pelos erros
                buttonText.textContent = `Próximo Erro (${currentWrongQuestionIndex + 1}/${wrongQuestionIndices.length})`;
                scrollToQuestion(wrongQuestionIndices[currentWrongQuestionIndex]);
            } else {
                // Não há erros para navegar, ir direto para o diagnóstico (embora hasErrors seja falso aqui)
                // Isso é um fallback se hasErrors por algum motivo for true, mas wrongQuestionIndices estiver vazio
                isShowingDiagnosis = true;
                arrowIcon.textContent = '⬆️'; // Seta para cima (já está no final)
                buttonText.textContent = 'Diagnóstico de Erros'; // Texto final
                
                // Preenche e exibe a seção de diagnóstico
                topicsToReviewList.innerHTML = ''; 
                for (const topic in errorCountByTopic) {
                    const errorsInTopic = errorCountByTopic[topic];
                    const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0; // Garante que não é undefined
                    
                    if (totalAnsweredInTopic > 0) { // Evita divisão por zero
                        const percentage = ((errorsInTopic / totalAnsweredInTopic) * 100).toFixed(1); 
                        const li = document.createElement('li');
                        li.textContent = `${topic}: ${percentage}% de erros (${errorsInTopic} de ${totalAnsweredInTopic} questões respondidas)`;
                        topicsToReviewList.appendChild(li);
                    }
                }
                errorDiagnosisSection.style.display = 'block'; 
                scrollToDiagnosis();
                errorNavBtn.style.display = 'none'; // Esconde o botão após ir para o diagnóstico final
            }

        } else if (isShowingErrors) { 
            // Se estamos no modo de navegar pelos erros (botão é "Próximo Erro")
            currentWrongQuestionIndex++;
            if (currentWrongQuestionIndex < wrongQuestionIndices.length) {
                // Ainda há erros para revisar
                scrollToQuestion(wrongQuestionIndices[currentWrongQuestionIndex]);
                buttonText.textContent = `Próximo Erro (${currentWrongQuestionIndex + 1}/${wrongQuestionIndices.length})`;
            } else {
                // Todos os erros foram revisados, agora mostra o diagnóstico
                isShowingErrors = false; 
                isShowingDiagnosis = true;
                arrowIcon.textContent = '⬇️'; // Seta para baixo para o diagnóstico (porque o diagnóstico está no final)
                buttonText.textContent = 'Diagnóstico de Erros'; // Texto final do botão

                // Preenche e exibe a seção de diagnóstico
                topicsToReviewList.innerHTML = ''; 
                for (const topic in errorCountByTopic) {
                    const errorsInTopic = errorCountByTopic[topic];
                    const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
                    
                    if (totalAnsweredInTopic > 0) {
                        const percentage = ((errorsInTopic / totalAnsweredInTopic) * 100).toFixed(1); 
                        const li = document.createElement('li');
                        li.textContent = `${topic}: ${percentage}% de erros (${errorsInTopic} de ${totalAnsweredInTopic} questões respondidas)`;
                        topicsToReviewList.appendChild(li);
                    }
                }
                errorDiagnosisSection.style.display = 'block'; 
                scrollToDiagnosis();
                errorNavBtn.style.display = 'none'; // Esconde o botão após ir para o diagnóstico final
            }
        } 
        // Se isShowingDiagnosis for true, não faz nada ao clicar no botão. Ele já deve ter desaparecido.
      });

      submitButton.addEventListener("click", showResults);

      buildQuiz();
    </script>
  </body>
</html>
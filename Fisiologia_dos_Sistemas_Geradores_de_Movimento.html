<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Fisiologia dos Sistemas Geradores de Movimento</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      background-color: #f4f4f4;
    }

    .quiz-container {
      max-width: 800px;
      width: 100%;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }

    .card {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .question {
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }

    .options {
      margin-top: 15px;
    }

    /* Estilos unificados para todas as opções (estáticas e dinâmicas) */
    .option, label.option, label, #newQuestionsContent label {
      display: flex; /* Para alinhar imagem e texto */
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      position: relative; /* Para posicionar a tesoura */
    }

    /* FORÇA a remoção de inputs de radio em QUALQUER lugar */
    .option input[type="radio"], 
    label input[type="radio"],
    #newQuestionsContent input[type="radio"],
    #newQuestionsContent label input[type="radio"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        position: absolute !important;
        left: -9999px !important;
    }

    .option:hover, 
    label.option:hover, 
    label:hover,
    #newQuestionsContent label:hover {
      background-color: #e9e9e9;
    }

    .option.selected, 
    label.option.selected, 
    label.selected,
    #newQuestionsContent label.selected {
      background-color: #d1e7dd;
      border-color: #28a745;
    }

    .option.correct, 
    label.option.correct, 
    label.correct,
    #newQuestionsContent label.correct {
      background-color: #d4edda;
      border-color: #28a745;
    }

    .option.incorrect, 
    label.option.incorrect, 
    label.incorrect,
    #newQuestionsContent label.incorrect {
      background-color: #f8d7da;
      border-color: #dc3545;
    }

    .submit-btn {
      display: block;
      width: 100%;
      padding: 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 30px;
    }

    .submit-btn:hover {
      background-color: #0056b3;
    }

    .results {
      text-align: center;
      margin-top: 30px;
      font-size: 20px;
      font-weight: bold;
      color: #333;
    }

    .scissor-icon {
      margin-right: 10px; /* Espaço entre a tesoura e o texto da opção */
      width: 20px; /* Ajuste conforme o tamanho da sua imagem */
      height: 20px; /* Ajuste conforme o tamanho da sua imagem */
      opacity: 0.5; /* Transparência como no original */
      cursor: pointer;
    }

    .scissor-icon.hidden {
      display: none;
    }

    .struck-through {
      text-decoration: line-through;
      color: #888;
    }

    .comment {
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f0f0;
      border-left: 4px solid #007bff;
      font-style: italic;
      color: #555;
      display: none; /* Escondido por padrão */
    }
    .comment.show {
      display: block; /* Mostrado quando ativado */
    }

    /* Estilos para o botão de navegação de erro / diagnóstico */
    .error-nav-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #dc3545; /* Vermelho para erro */
      color: white;
      border: none;
      border-radius: 50%; /* Torna o botão redondo */
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      display: none; /* Escondido por padrão */
      flex-direction: column; /* Para empilhar o ícone e o contador */
      padding: 5px; /* Ajuste o padding para acomodar texto maior */
      box-sizing: border-box; /* Garante que padding não aumente o tamanho total */
      text-align: center;
    }

    .error-nav-btn:hover {
      background-color: #c82333;
    }

    .error-nav-btn .arrow-icon {
      font-size: 30px; /* Tamanho da seta */
      line-height: 1; /* Ajuste para centralizar */
    }

    .error-nav-btn .button-text {
      font-size: 12px; /* Tamanho do texto abaixo da seta */
      line-height: 1;
      margin-top: 2px; /* Espaço entre a seta e o texto */
    }

    /* Estilos para a seção de diagnóstico de erros */
    .error-diagnosis-section {
        margin-top: 50px;
        padding: 30px;
        background-color: #ffe0b2; /* Um laranja claro ou similar */
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        display: none; /* Escondido por padrão */
        text-align: center;
        font-size: 1.1em;
        color: #333;
    }

    .error-diagnosis-section h2 {
        color: #e65100; /* Laranja mais escuro */
        margin-bottom: 20px;
        font-size: 1.8em;
    }

    .error-diagnosis-section ul {
        list-style: none; /* Remove marcadores de lista */
        padding: 0;
        margin: 0;
    }

    .error-diagnosis-section li {
        background-color: #ff9800; /* Laranja */
        color: white;
        padding: 8px 15px;
        margin: 8px 0;
        border-radius: 5px;
        display: inline-block; /* Para que os itens fiquem lado a lado */
        margin-right: 10px;
        font-weight: bold;
    }
    .error-diagnosis-section li:last-child {
        margin-right: 0;
    }
 .card-bloco {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      background: #fff;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1 style="text-align:center; margin-bottom: 30px;">Simulado de Fisiologia dos Sistemas Geradores de Movimento</h1>
    <div class="card-bloco" id="quiz"></div>
    <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>

    <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">
      Gerar Novas Perguntas
    </button>

    <div class="results card-bloco" id="results"></div>
    <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>

    <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
      <h2>Diagnóstico de Erros</h2>
      <p>Parece que você precisa revisar os seguintes assuntos:</p>
      <ul id="topicsToReview"></ul>
    </div>

    <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
      <h2>Novas Perguntas Geradas</h2>
      <div id="newQuestionsContent"></div>
    </div>
  </div>
  
  <button class="error-nav-btn" id="errorNavBtn" style="display:none;">
    <span class="arrow-icon"></span>
    <span class="button-text"></span>
  </button>

  <script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorNavBtn = document.getElementById("errorNavBtn");
    const arrowIcon = errorNavBtn.querySelector(".arrow-icon");
    const buttonText = errorNavBtn.querySelector(".button-text");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};
    let totalAnsweredQuestionsByTopic = {};
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;
    let isShowingErrors = false;
    let isShowingDiagnosis = false;

    // Inicializa a visibilidade das seções no carregamento
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    const questions = [
      {
        question: "1. Qual é a principal função do córtex motor primário (M1) no controle dos movimentos voluntários?",
        options: [
          "a) Planejamento e coordenação de movimentos complexos.",
          "b) Geração e controle direto dos movimentos voluntários, sendo a principal área de saída para sinais motores.",
          "c) Regulação do tônus muscular e equilíbrio postural.",
          "d) Iniciação de movimentos auto-iniciados e coordenação de movimentos bilaterais."
        ],
        correctAnswer: "b) Geração e controle direto dos movimentos voluntários, sendo a principal área de saída para sinais motores.",
        comment: "O córtex motor primário (M1) é a área do córtex motor que se projeta diretamente para a medula espinhal e é fundamental para a execução dos movimentos voluntários, atuando como o ponto principal de onde os comandos motores são enviados.",
        topic: "Córtex Motor Primário"
      },
      {
        question: "2. O que significa a organização 'somatotópica' do córtex motor primário?",
        options: [
          "a) Diferentes áreas do córtex motor controlam diferentes funções cognitivas.",
          "b) Apenas movimentos automáticos são representados no córtex motor.",
          "c) Diferentes partes do corpo são representadas em regiões específicas e organizadas do córtex motor.",
          "d) O córtex motor é responsável apenas pelo controle da fala e da visão."
        ],
        correctAnswer: "c) Diferentes partes do corpo são representadas em regiões específicas e organizadas do córtex motor.",
        comment: "A organização somatotópica refere-se ao mapeamento ordenado das partes do corpo no córtex cerebral. No córtex motor primário, isso significa que neurônios em uma área específica controlam músculos de uma parte específica do corpo, formando o que é conhecido como homúnculo motor.",
        topic: "Córtex Motor Primário"
      },
      {
        question: "3. Qual neurocirurgião é associado ao mapeamento do córtex motor através da estimulação elétrica, resultando no conceito de 'homúnculo motor'?",
        options: [
          "a) Santiago Ramón y Cajal",
          "b) Charles Sherrington",
          "c) Wilder Penfield",
          "d) Korbinian Brodmann"
        ],
        correctAnswer: "c) Wilder Penfield",
        comment: "Wilder Penfield foi o neurocirurgião que, através da estimulação elétrica do cérebro de pacientes conscientes durante cirurgias, conseguiu mapear as representações sensoriais e motoras do corpo no córtex, popularizando o conceito do homúnculo motor.",
        topic: "Córtex Motor Primário"
      },
      {
        question: "4. A 'Área Pré-Motora' é principalmente envolvida em qual aspecto do controle motor?",
        options: [
          "a) Execução direta de movimentos simples.",
          "b) Planejamento e coordenação de movimentos complexos e aprendizagem de novos movimentos.",
          "c) Regulação da força muscular.",
          "d) Manutenção do equilíbrio estático."
        ],
        correctAnswer: "b) Planejamento e coordenação de movimentos complexos e aprendizagem de novos movimentos.",
        comment: "A área pré-motora atua na preparação e na organização de sequências de movimentos, bem como na integração de informações sensoriais para guiar esses movimentos, sendo crucial para o planejamento motor.",
        topic: "Área Pré-Motora"
      },
      {
        question: "5. Qual a função da 'Área Motora Suplementar (SMA)'?",
        options: [
          "a) Controlar movimentos reflexos.",
          "b) Iniciar movimentos auto-iniciados e coordenar movimentos bilaterais e sequenciais.",
          "c) Processar informações sensoriais táteis.",
          "d) Regular a temperatura corporal."
        ],
        correctAnswer: "b) Iniciar movimentos auto-iniciados e coordenar movimentos bilaterais e sequenciais.",
        comment: "A SMA é fundamental para a execução de movimentos que não são guiados por estímulos externos, mas sim pela própria intenção do indivíduo, e também para a coordenação de ações que envolvem ambos os lados do corpo ou sequências de movimentos.",
        topic: "Área Motora Suplementar"
      },
      {
        question: "6. O córtex cingulado anterior, uma parte do córtex cingulado, participa do controle motor principalmente em que contexto?",
        options: [
          "a) Reflexos de retirada.",
          "b) Seleção de respostas em situações que exigem escolhas de ação.",
          "c) Regulação do ritmo cardíaco.",
          "d) Processamento de informações visuais."
        ],
        correctAnswer: "b) Seleção de respostas em situações que exigem escolhas de ação.",
        comment: "O córtex cingulado anterior está envolvido em funções executivas, incluindo a tomada de decisões e a seleção de ações quando há múltiplas opções de resposta disponíveis, influenciando assim o controle motor em contextos de escolha.",
        topic: "Córtex Cingulado"
      },
      {
        question: "7. Qual estrutura do encéfalo é essencial para a coordenação motora, garantindo movimentos suaves, precisos e harmoniosos?",
        options: [
          "a) Tálamo",
          "b) Hipotálamo",
          "c) Cerebelo",
          "d) Medula oblonga"
        ],
        correctAnswer: "c) Cerebelo",
        comment: "O cerebelo é conhecido como o 'pequeno cérebro' devido à sua importância na coordenação, ajuste e aprendizado motor. Ele refina os comandos motores, permitindo movimentos fluidos e precisos.",
        topic: "Cerebelo"
      },
      {
        question: "8. Além da coordenação motora, o cerebelo também regula qual outro aspecto crucial para a postura e equilíbrio?",
        options: [
          "a) Pressão arterial.",
          "b) Tônus muscular.",
          "c) Frequência respiratória.",
          "d) Temperatura corporal."
        ],
        correctAnswer: "b) Tônus muscular.",
        comment: "O cerebelo desempenha um papel vital na manutenção da postura e do equilíbrio, ajustando continuamente o tônus muscular em resposta a informações sensoriais do corpo e do ambiente.",
        topic: "Cerebelo"
      },
      {
        question: "9. Quais são as três principais divisões funcionais do cerebelo mencionadas no texto?",
        options: [
          "a) Lobo frontal, lobo parietal e lobo temporal.",
          "b) Vestíbulo cerebelo, espinho cerebelo e cérebro cerebelo.",
          "c) Córtex, medula e gânglios.",
          "d) Cerebelo anterior, cerebelo médio e cerebelo posterior."
        ],
        correctAnswer: "b) Vestíbulo cerebelo, espinho cerebelo e cérebro cerebelo.",
        comment: "Essas são as três divisões anatômicas e funcionais do cerebelo, cada uma envolvida em aspectos específicos do controle motor e do equilíbrio.",
        topic: "Anatomia Cerebelar"
      },
      {
        question: "10. Qual tipo de fibra aferente cerebelar vem principalmente de várias partes do cérebro e medula espinhal, formando sinapses com células granulares?",
        options: [
          "a) Fibras trepadeiras.",
          "b) Fibras de Purkinje.",
          "c) Fibras musgosas.",
          "d) Fibras de Golgi."
        ],
        correctAnswer: "c) Fibras musgosas.",
        comment: "As fibras musgosas são uma das duas principais entradas para o cerebelo, trazendo uma vasta gama de informações sensoriais e motoras para o córtex cerebelar, principalmente para as células granulares.",
        topic: "Sistema Aferente Cerebelar"
      },
      {
        question: "11. Qual tipo de fibra aferente cerebelar é caracterizado por disparos complexos e se origina no núcleo olivar inferior do tronco cerebral, formando sinapses diretas com as células de Purkinje?",
        options: [
          "a) Fibras musgosas.",
          "b) Fibras trepadeiras.",
          "c) Fibras paralelas.",
          "d) Fibras de Marr."
        ],
        correctAnswer: "b) Fibras trepadeiras.",
        comment: "As fibras trepadeiras são únicas por sua poderosa influência nas células de Purkinje, causando disparos complexos e sendo importantes para o aprendizado motor e a correção de erros.",
        topic: "Sistema Aferente Cerebelar"
      },
      {
        question: "12. Qual é a principal função das células de Purkinje no sistema eferente cerebelar?",
        options: [
          "a) Transmitir sinais excitatórios para o cerebelo.",
          "b) Receber informações sensoriais diretamente dos músculos.",
          "c) Transmitir informações inibitórias dos núcleos profundos do cerebelo para outras partes do cérebro.",
          "d) Transmitir informações inibitórias do cerebelo para os núcleos profundos."
        ],
        correctAnswer: "d) Transmitir informações inibitórias do cerebelo para os núcleos profundos.",
        comment: "As células de Purkinje são os únicos neurônios de saída do córtex cerebelar e exercem uma influência inibitória sobre os neurônios dos núcleos cerebelares profundos, que por sua vez projetam-se para outras partes do cérebro.",
        topic: "Sistema Eferente Cerebelar"
      },
      {
        question: "13. Uma característica importante das lesões cerebelares, diferentemente da maioria do sistema nervoso, é que elas afetam qual lado do corpo?",
        options: [
          "a) O lado oposto (contralateral).",
          "b) O mesmo lado (ipsilateral).",
          "c) Ambos os lados igualmente.",
          "d) Apenas os membros superiores."
        ],
        correctAnswer: "b) O mesmo lado (ipsilateral).",
        comment: "Devido a um duplo cruzamento das vias neurais, as lesões no cerebelo causam déficits motores no mesmo lado do corpo onde ocorreu a lesão, o que é uma particularidade em comparação com outras áreas do sistema nervoso central.",
        topic: "Lesões Cerebelares"
      },
      {
        question: "14. Qual sintoma de lesão cerebelar se refere à falta de coordenação de movimentos?",
        options: [
          "a) Bradicinesia.",
          "b) Rigidez.",
          "c) Ataxia.",
          "d) Distonia."
        ],
        correctAnswer: "c) Ataxia.",
        comment: "Ataxia é um termo amplo que descreve a perda de coordenação dos movimentos voluntários, resultando em movimentos irregulares, desajeitados e imprecisos, frequentemente observada em disfunções cerebelares.",
        topic: "Lesões Cerebelares"
      },
      {
        question: "15. A incapacidade de julgar a distância de um movimento, levando a movimentos que 'erram o alvo', é conhecida como:",
        options: [
          "a) Disdiadococinesia.",
          "b) Dismetria.",
          "c) Fala escandia.",
          "d) Tremor de repouso."
        ],
        correctAnswer: "b) Dismetria.",
        comment: "A dismetria é um sinal clássico de disfunção cerebelar, onde o indivíduo tem dificuldade em controlar a amplitude ou a força de um movimento, resultando em superestimação (hipermetria) ou subestimação (hipometria) do alvo.",
        topic: "Lesões Cerebelares"
      },
      {
        question: "16. O que é 'Fala Escandia' (ou disartria cerebelar)?",
        options: [
          "a) Fala rápida e ininteligível.",
          "b) Fala monótona e sem entonação.",
          "c) Fala lenta e arrastada, com pronúncia separada de cada sílaba.",
          "d) Dificuldade em compreender a fala."
        ],
        correctAnswer: "c) Fala lenta e arrastada, com pronúncia separada de cada sílaba.",
        comment: "A fala escandia é um distúrbio da fala que resulta da falta de coordenação dos músculos envolvidos na produção da fala, característica de lesões cerebelares.",
        topic: "Lesões Cerebelares"
      },
      {
        question: "17. Um tremor que ocorre durante o movimento voluntário e piora ao se aproximar do objetivo é conhecido como:",
        options: [
          "a) Tremor essencial.",
          "b) Tremor de repouso.",
          "c) Tremor de intenção.",
          "d) Tremor postural."
        ],
        correctAnswer: "c) Tremor de intenção.",
        comment: "O tremor de intenção é um tipo de tremor que se manifesta ou piora com a realização de um movimento voluntário direcionado a um alvo, sendo um indicativo comum de disfunção cerebelar.",
        topic: "Lesões Cerebelares"
      },
      {
        question: "18. Qual grupo de núcleos cerebrais é responsável por regular os movimentos, ajudando a iniciar movimentos, regular movimentos automáticos e postura, e envolvido na aprendizagem de habilidades motoras?",
        options: [
          "a) Tálamo.",
          "b) Hipocampo.",
          "c) Gânglios da base.",
          "d) Córtex somatossensorial."
        ],
        correctAnswer: "c) Gânglios da base.",
        comment: "Os gânglios da base são um conjunto de núcleos subcorticais interconectados que desempenham um papel crucial na seleção, iniciação e modulação dos movimentos voluntários, bem como na formação de hábitos motores.",
        topic: "Gânglios da Base"
      },
      {
        question: "19. Quais são as três principais estruturas que compõem os gânglios da base mencionadas no texto?",
        options: [
          "a) Córtex, cerebelo e tronco cerebral.",
          "b) Tálamo, hipotálamo e amígdala.",
          "c) Núcleo caudado, putâmen e globo pálido.",
          "d) Ponte, bulbo e mesencéfalo."
        ],
        correctAnswer: "c) Núcleo caudado, putâmen e globo pálido.",
        comment: "O núcleo caudado e o putâmen formam o estriado, a principal porta de entrada para os gânglios da base, enquanto o globo pálido é a principal saída, modulando o tálamo e, consequentemente, o córtex motor.",
        topic: "Anatomia dos Gânglios da Base"
      },
      {
        question: "20. O núcleo caudado e o putâmen, conhecidos em conjunto como estriado, são a principal entrada para qual estrutura?",
        options: [
          "a) Tálamo.",
          "b) Cerebelo.",
          "c) Gânglios da base.",
          "d) Córtex pré-frontal."
        ],
        correctAnswer: "c) Gânglios da base.",
        comment: "O estriado (formado pelo núcleo caudado e putâmen) recebe a maior parte das informações excitatórias do córtex cerebral, servindo como o principal ponto de entrada para o processamento de informações pelos gânglios da base.",
        topic: "Gânglios da Base"
      },
      {
        question: "21. Qual é a principal área de saída dos gânglios da base, enviando projeções para o tálamo e, subsequentemente, para o córtex motor e pré-motor?",
        options: [
          "a) Núcleo subtalâmico.",
          "b) Substância negra.",
          "c) Globo pálido.",
          "d) Núcleo accumbens."
        ],
        correctAnswer: "c) Globo pálido.",
        comment: "O globo pálido, especialmente sua porção interna (GPi), é a principal via de saída dos gânglios da base, modulando a atividade do tálamo e, por extensão, a excitabilidade do córtex motor.",
        topic: "Anatomia dos Gânglios da Base"
      },
      {
        question: "22. A 'Via Direta' dos gânglios da base é responsável por qual aspecto do movimento?",
        options: [
          "a) Inibição do movimento.",
          "b) Excitação do movimento.",
          "c) Coordenação motora fina.",
          "d) Aprendizagem de habilidades sensoriais."
        ],
        correctAnswer: "b) Excitação do movimento.",
        comment: "A via direta dos gânglios da base atua desinibindo o tálamo, o que leva a um aumento da atividade no córtex motor e facilita a iniciação e execução dos movimentos desejados.",
        topic: "Circuitos dos Gânglios da Base"
      },
      {
        question: "23. A 'Via Indireta' dos gânglios da base é responsável por qual aspecto do movimento?",
        options: [
          "a) Excitação do movimento.",
          "b) Facilitação do movimento.",
          "c) Inibição do movimento.",
          "d) Coordenação dos movimentos oculares."
        ],
        correctAnswer: "c) Inibição do movimento.",
        comment: "A via indireta dos gânglios da base, ao contrário da via direta, atua de forma a aumentar a inibição talâmica do córtex motor, suprimindo assim movimentos indesejados e modulando a amplitude dos movimentos.",
        topic: "Circuitos dos Gânglios da Base"
      },
      {
        question: "24. Qual doença neurodegenerativa é caracterizada pela perda progressiva de neurônios dopaminérgicos na substância negra?",
        options: [
          "a) Doença de Alzheimer.",
          "b) Esclerose Múltipla.",
          "c) Doença de Parkinson.",
          "d) Doença de Huntington."
        ],
        correctAnswer: "c) Doença de Parkinson.",
        comment: "A Doença de Parkinson é classicamente associada à degeneração dos neurônios que produzem dopamina na substância negra, uma área dos gânglios da base, resultando em sintomas motores como tremor, rigidez e bradicinesia.",
        topic: "Disfunções dos Gânglios da Base: Doença de Parkinson"
      },
      {
        question: "25. Qual é um dos sintomas motores clássicos da Doença de Parkinson mencionado no texto?",
        options: [
          "a) Coreia (movimentos involuntários rápidos).",
          "b) Ataxia.",
          "c) Tremor em repouso.",
          "d) Hipercinesia."
        ],
        correctAnswer: "c) Tremor em repouso.",
        comment: "O tremor em repouso é um dos sintomas cardinais da Doença de Parkinson, que se manifesta quando a pessoa está em repouso e diminui ou cessa com o movimento voluntário.",
        topic: "Disfunções dos Gânglios da Base: Doença de Parkinson"
      },
      {
        question: "26. A Doença de Huntington é uma doença genética que causa a morte de células cerebrais, incluindo nos gânglios da base, e é caracterizada por qual tipo de movimento involuntário?",
        options: [
          "a) Rigidez.",
          "b) Bradicinesia.",
          "c) Coreia.",
          "d) Tremor de intenção."
        ],
        correctAnswer: "c) Coreia.",
        comment: "A coreia, caracterizada por movimentos involuntários rápidos, bruscos e imprevisíveis, é o principal distúrbio do movimento na Doença de Huntington, diferenciando-a de outras disfunções dos gânglios da base como o Parkinson.",
        topic: "Disfunções dos Gânglios da Base: Doença de Huntington"
      },
      {
        question: "27. Como o córtex motor e os gânglios da base interagem para o controle do movimento?",
        options: [
          "a) O córtex motor envia informações excitatórias para os gânglios da base, que modulam o feedback para o córtex motor via tálamo.",
          "b) Os gânglios da base enviam sinais diretamente para os músculos.",
          "c) O córtex motor recebe feedback direto do cerebelo.",
          "d) Não há interação entre o córtex motor e os gânglios da base."
        ],
        correctAnswer: "a) O córtex motor envia informações excitatórias para os gânglios da base, que modulam o feedback para o córtex motor via tálamo.",
        comment: "O circuito entre o córtex motor, gânglios da base e tálamo é uma alça de feedback que permite aos gânglios da base refinar e selecionar os comandos motores do córtex, facilitando movimentos desejados e inibindo os indesejados.",
        topic: "Interação Córtex Motor e Gânglios da Base"
      },
      {
        question: "28. Qual a função do cerebelo na sua interação com o córtex motor, atuando como um 'computador'?",
        options: [
          "a) Gerar os comandos motores iniciais.",
          "b) Processar informações sensoriais e motoras para coordenar e ajustar movimentos.",
          "c) Iniciar movimentos automáticos.",
          "d) Suprimir todos os movimentos involuntários."
        ],
        correctAnswer: "b) Processar informações sensoriais e motoras para coordenar e ajustar movimentos.",
        comment: "O cerebelo recebe uma cópia do plano motor do córtex e, ao mesmo tempo, informações sensoriais sobre a posição do corpo, permitindo que ele faça ajustes em tempo real para garantir a precisão e a suavidade do movimento.",
        topic: "Interação Córtex Motor e Cerebelo"
      },
      {
        question: "29. O cerebelo e os gânglios da base interagem de forma direta ou indireta?",
        options: [
          "a) Direta, através de conexões nervosas primárias.",
          "b) Indireta, através de suas conexões com o córtex motor e o tálamo.",
          "c) Não interagem.",
          "d) Apenas por meio de neurotransmissores circulantes."
        ],
        correctAnswer: "b) Indireta, através de suas conexões com o córtex motor e o tálamo.",
        comment: "Embora não haja uma conexão anatômica direta e substancial entre o cerebelo e os gânglios da base, eles se comunicam funcionalmente e colaboram na modulação do movimento, influenciando o córtex motor de maneiras complementares através do tálamo.",
        topic: "Interação Cerebelo e Gânglios da Base"
      },
      {
        question: "30. Qual das seguintes áreas do córtex motor é mais relevante para o planejamento de movimentos e a aprendizagem de novas habilidades motoras, recebendo informações sensoriais para guiar a ação?",
        options: [
          "a) Córtex Motor Primário (M1).",
          "b) Córtex Somatossensorial Primário.",
          "c) Área Pré-Motora.",
          "d) Lobo Occipital."
        ],
        correctAnswer: "c) Área Pré-Motora.",
        comment: "A área pré-motora está envolvida em preparar e sequenciar movimentos, especialmente aqueles que exigem interação com estímulos sensoriais externos ou que são mais complexos e novos, diferentemente do M1 que executa comandos mais diretos.",
        topic: "Área Pré-Motora"
      },
      {
        question: "31. As camadas do cerebelo, da mais externa para a mais interna, são:",
        options: [
          "a) Granular, Purkinje, Molecular.",
          "b) Molecular, Granular, Purkinje.",
          "c) Purkinje, Molecular, Granular.",
          "d) Molecular, Purkinje, Granular."
        ],
        correctAnswer: "d) Molecular, Purkinje, Granular.",
        comment: "O córtex cerebelar é dividido em três camadas distintas: a camada molecular (mais externa), a camada de células de Purkinje (intermediária, contendo os corpos celulares dos principais neurônios de saída) e a camada granular (mais interna, com as células granulares).",
        topic: "Anatomia Cerebelar"
      },
      {
        question: "32. Quais estruturas são apresentadas na Figura 1 como parte da anatomia do cérebro e do córtex motor?",
        options: [
          "a) Medula espinhal, cerebelo, tálamo, hipotálamo.",
          "b) Lobo Frontal, Córtex Motor Primário, Sulco Central, Cerebelo.",
          "c) Bulbo Olfatório, Ponte, Mesencéfalo, Córtex Cingulado.",
          "d) Hipocampo, Amígdala, Núcleos da Base, Giro Cingulado."
        ],
        correctAnswer: "b) Lobo Frontal, Córtex Motor Primário, Sulco Central, Cerebelo.",
        comment: "A Figura 1 no PDF ilustra uma vista lateral do cérebro, destacando especificamente o lobo frontal, o córtex motor primário dentro dele, o sulco central que o delimita, e o cerebelo na parte posterior.",
        topic: "Anatomia Cerebral"
      },
      {
        question: "33. Qual a principal função da bainha de mielina no sistema nervoso, conforme implícito no contexto do potencial de ação?",
        options: [
          "a) Diminuir a velocidade de propagação do impulso nervoso.",
          "b) Aumentar a resistência elétrica do axônio.",
          "c) Aumentar a velocidade de propagação do potencial de ação.",
          "d) Produzir neurotransmissores."
        ],
        correctAnswer: "c) Aumentar a velocidade de propagação do potencial de ação.",
        comment: "Embora o conceito de bainha de mielina não seja detalhado no quiz, o PDF aborda a propagação do potencial de ação. A mielina isola o axônio, permitindo a condução saltatória do impulso nervoso entre os Nodos de Ranvier, o que aumenta significativamente a velocidade de transmissão.",
        topic: "Propagação do Potencial de Ação"
      },
      {
        question: "34. Em qual seção do PDF os sintomas de disfunções dos gânglios da base, como Doença de Parkinson e Doença de Huntington, são discutidos?",
        options: [
          "a) Introdução.",
          "b) Córtex Motor.",
          "c) Gânglios da Base.",
          "d) Cerebelo."
        ],
        correctAnswer: "c) Gânglios da Base.",
        comment: "As disfunções dos gânglios da base, incluindo as doenças de Parkinson e Huntington, são diretamente relacionadas ao mau funcionamento dessas estruturas, e por isso são abordadas na seção dedicada a elas.",
        topic: "Gânglios da Base"
      },
      {
        question: "35. A 'Figura 3. Anatomia cerebelar' mostra uma vista superior do cerebelo detalhando quais estruturas principais?",
        options: [
          "a) Córtex Cerebral Direito, Corpo Caloso, Plexo Coroide.",
          "b) Lobo Anterior, Lobo Posterior, Vérmis, Hemisfério Lateral.",
          "c) Bulbo, Ponte, Medula Oblongata.",
          "d) Substância Negra, Núcleo Caudado, Putâmen."
        ],
        correctAnswer: "b) Lobo Anterior, Lobo Posterior, Vérmis, Hemisfério Lateral.",
        comment: "A Figura 3 fornece uma visão detalhada da anatomia cerebelar, especificando os lobos anterior e posterior, o vérmis (parte central) e os hemisférios cerebelares laterais.",
        topic: "Anatomia Cerebelar"
      },
      {
        question: "36. Qual a principal característica que diferencia uma sinapse química de uma sinapse elétrica, conforme o contexto geral da neurofisiologia?",
        options: [
          "a) Velocidade de transmissão.",
          "b) Direcionalidade do sinal.",
          "c) Utilização de neurotransmissores e fenda sináptica.",
          "d) Capacidade de modulação."
        ],
        correctAnswer: "c) Utilização de neurotransmissores e fenda sináptica.",
        comment: "Embora o PDF não entre em detalhes profundos sobre os tipos de sinapse (além de mencioná-las brevemente no contexto dos neurotransmissores), a característica fundamental da sinapse química é a liberação de mensageiros químicos (neurotransmissores) em uma fenda sináptica para comunicar-se com a célula pós-sináptica, em contraste com a sinapse elétrica que usa junções comunicantes diretas.",
        topic: "Transmissão Sináptica"
      },
      {
        question: "37. O 'homúnculo motor' de Penfield ilustra que a representação cortical do corpo não é proporcional ao seu tamanho, mas sim à:",
        options: [
          "a) Idade do indivíduo.",
          "b) Precisão dos movimentos e complexidade da tarefa.",
          "c) Quantidade de tecido muscular.",
          "d) Capacidade de regeneração do tecido."
        ],
        correctAnswer: "b) Precisão dos movimentos e complexidade da tarefa.",
        comment: "A representação desproporcional do homúnculo motor demonstra que áreas do corpo com movimentos finos e complexos, como as mãos e a face, possuem uma área cortical maior dedicada ao seu controle, refletindo a densidade de neurônios necessária para a precisão.",
        topic: "Córtex Motor Primário"
      },
      {
        question: "38. Qual sintoma da Doença de Parkinson é uma diminuição ou lentidão dos movimentos?",
        options: [
          "a) Distonia.",
          "b) Acinesia.",
          "c) Coreia.",
          "d) Bradicinesia."
        ],
        correctAnswer: "d) Bradicinesia.",
        comment: "Bradicinesia é um sintoma central da Doença de Parkinson, caracterizado pela lentidão dos movimentos e dificuldade em realizar tarefas motoras, contribuindo para a redução da agilidade e fluidez.",
        topic: "Disfunções dos Gânglios da Base: Doença de Parkinson"
      },
      {
        question: "39. A 'Substância Negra', cuja degeneração é central na Doença de Parkinson, está localizada em qual parte do encéfalo?",
        options: [
          "a) Cerebelo.",
          "b) Medula espinhal.",
          "c) Tronco cerebral (mesencéfalo).",
          "d) Córtex cerebral."
        ],
        correctAnswer: "c) Tronco cerebral (mesencéfalo).",
        comment: "A substância negra é uma estrutura vital dos gânglios da base, localizada no mesencéfalo (parte do tronco cerebral), e é a principal fonte de dopamina para o estriado, sendo crucial para a modulação do movimento.",
        topic: "Disfunções dos Gânglios da Base: Doença de Parkinson"
      },
      {
        question: "40. Qual é o papel principal da interação entre o córtex motor, o cerebelo e os gânglios da base, conforme a conclusão do documento?",
        options: [
          "a) Cada estrutura funciona independentemente para controlar partes distintas do corpo.",
          "b) Eles formam uma rede complexa que trabalha em conjunto para iniciar, coordenar e modular o movimento.",
          "c) O cerebelo é a única estrutura responsável por todos os movimentos voluntários.",
          "d) Os gânglios da base apenas suprimem movimentos indesejados."
        ],
        correctAnswer: "b) Eles formam uma rede complexa que trabalha em conjunto para iniciar, coordenar e modular o movimento.",
        comment: "A interação sinérgica entre o córtex motor (iniciação e direcionamento), o cerebelo (coordenação e precisão) e os gânglios da base (modulação, seleção e iniciação/supressão de movimentos) é essencial para a execução de movimentos voluntários suaves, coordenados e adaptados.",
        topic: "Interação dos Sistemas Geradores de Movimento"
      }
    ];

    function buildQuiz() {
      const output = [];

      questions.forEach((currentQuestion, questionNumber) => {
        const options = [];
        for (let i = 0; i < currentQuestion.options.length; i++) {
          options.push(
            `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
              <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
              ${currentQuestion.options[i]}
            </label>`
          );
        }

        output.push(
          `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
            <div class="question">${currentQuestion.question}</div>
            <div class="options">${options.join("")}</div>
            <div class="comment" id="comment-${questionNumber}"></div>
          </div>`
        );
      });

      quizContainer.innerHTML = output.join("");
    }

    function showResults() {
      wrongQuestionIndices = [];
      errorCountByTopic = {};
      totalAnsweredQuestionsByTopic = {};
      currentWrongQuestionIndex = -1;
      hasErrors = false;
      isShowingErrors = false;
      isShowingDiagnosis = false;

      errorDiagnosisSection.style.display = 'none';
      topicsToReviewList.innerHTML = '';
      statusMessage.textContent = '';

      // Busca por todas as perguntas: estáticas e dinâmicas
      const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
      let correctAnswersCount = 0;
      let totalQuestionsAnswered = 0;

      console.log('🔍 Verificando', allQuestionCards.length, 'perguntas...');

      allQuestionCards.forEach((card, index) => {
        const questionEl = card.querySelector('.question') || card.querySelector('p');
        if (!questionEl) return;

        const questionText = questionEl.textContent.trim();
        const optionsContainer = card.querySelector('.options') || card;
        const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
        const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
        const commentDiv = card.querySelector('.comment');

        const questionTopic = card.dataset.topic || "Tópico não informado";
        
        console.log(`📝 Pergunta ${index + 1}: Tópico = "${questionTopic}"`);
        console.log(`🔍 Encontradas ${allOptions.length} alternativas`);
        
        // Remove classes anteriores
        allOptions.forEach(option => {
          option.classList.remove('correct', 'incorrect', 'selected');
        });
        if (commentDiv) commentDiv.classList.remove('show');

        let correctAnswerValue = null;
        let questionComment = null;

        // Verifica se é pergunta estática ou dinâmica
        const isStatic = card.id && card.id.startsWith('question-');
        if (isStatic) {
          // Pergunta estática - busca nos dados originais
          const questionData = questions.find(q => q.question.trim() === questionText);
          if (questionData) {
            correctAnswerValue = questionData.correctAnswer.trim();
            questionComment = questionData.comment;
          }
        } else {
          // Pergunta dinâmica - busca pela opção marcada como correta
          const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
          if (correctOpt) {
            correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
            console.log(`✅ Resposta correta encontrada: "${correctAnswerValue}"`);
          } else {
            console.log('❌ Nenhuma resposta correta encontrada para pergunta dinâmica');
          }
          
          // Busca comentário no próprio card ou no div comment
          const commentElement = card.querySelector('.comment');
          if (commentElement && commentElement.textContent.trim()) {
            questionComment = commentElement.textContent.trim();
          }
        }

        // Processa resposta do usuário e aplica coloração
        let userAnswer = null;
        if (userAnswerElement) {
          userAnswerElement.classList.add('selected');
          userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
          totalQuestionsAnswered++;
          totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

          console.log(`👤 Resposta do usuário: "${userAnswer}"`);
          console.log(`🎯 Resposta correta: "${correctAnswerValue}"`);

          // Verifica se a resposta está correta
          if (userAnswer === correctAnswerValue) {
            correctAnswersCount++;
            console.log(`✅ Resposta correta!`);
          } else {
            hasErrors = true;
            errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
            console.log(`❌ Resposta incorreta para tópico: ${questionTopic}`);
          }
        }

        // Aplica coloração: SEMPRE marca a correta de verde, e a errada de vermelho se foi marcada
        allOptions.forEach(option => {
          const optionValue = option.dataset.value?.trim() || option.textContent.trim();
          
          // Marca a resposta correta de verde SEMPRE
          if (optionValue === correctAnswerValue) {
            option.classList.add('correct');
            console.log(`🟢 Marcando como correta: "${optionValue}"`);
          }
          
          // Se o usuário marcou uma resposta E ela está errada, marca de vermelho
          if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) {
            option.classList.add('incorrect');
            console.log(`🔴 Marcando como incorreta: "${optionValue}"`);
          }
        });

        // Mostra comentário se disponível
        if (commentDiv && questionComment) {
          commentDiv.textContent = questionComment;
          commentDiv.classList.add('show');
        }
      });

      // Exibe resultados
      resultsContainer.textContent = `Você acertou ${correctAnswersCount} de ${totalQuestionsAnswered} questões respondidas.`;

      console.log('📊 Erros por tópico:', errorCountByTopic);
      console.log('📊 Total por tópico:', totalAnsweredQuestionsByTopic);

      // Gera diagnóstico de erros
      if (hasErrors) {
        for (const topic in errorCountByTopic) {
          const errors = errorCountByTopic[topic];
          const total = totalAnsweredQuestionsByTopic[topic] || 0;
          if (total > 0) {
            const percent = ((errors / total) * 100).toFixed(1);
            const li = document.createElement('li');
            li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} questões respondidas)`;
            topicsToReviewList.appendChild(li);
          }
        }
      } else {
        const li = document.createElement('li');
        li.textContent = "🥳 Parabéns! Você não teve erros nas questões respondidas.";
        topicsToReviewList.appendChild(li);
      }

      errorDiagnosisSection.style.display = 'block';
      generatedQuestionsSection.style.display = 'block';
      generateNewQuestionsBtn.style.display = 'block';
      scrollToDiagnosis();
    }

    function scrollToQuestion(index) {
      const questionCard = document.getElementById(`question-${index}`);
      if (questionCard) {
        questionCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function scrollToDiagnosis() {
        errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function scrollToGeneratedQuestions() {
        generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Event listener para seleção de opções (funciona para estáticas e dinâmicas)
    document.addEventListener("click", function (event) {
      const clickedElement = event.target;
      const optionElement = clickedElement.closest('.option');

      if (optionElement) {
          if (clickedElement.classList.contains("scissor-icon")) {
              event.stopPropagation();
              optionElement.classList.toggle("struck-through");
          }
          else {
              const parentCard = optionElement.closest('.card');
              const currentQuestionOptions = parentCard.querySelectorAll('.option');

              currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
              optionElement.classList.add("selected");
          }
      }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '⏳ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;

        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });

        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            newQuestionsContent.innerHTML = '';
            if (data && data.html) {
                console.log('📥 HTML recebido do Flask:', data.html);
                
                // Insere o HTML diretamente sem reconstrução complexa
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                // Adiciona tesouras e ajusta formatação apenas se necessário
                newQuestionsContent.querySelectorAll('.card').forEach((card, cardIndex) => {
                    // Garante que o elemento de pergunta tenha a classe correta
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) {
                       questionElement.classList.add('question');
                    }

                    // Remove qualquer input de radio que possa existir e adiciona tesouras
                    card.querySelectorAll('label').forEach((label) => {
                        // Remove inputs de radio MAS preserva o atributo data-answer
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            // PRESERVA o atributo data-answer do input no label
                            if (radioInput.hasAttribute('data-answer')) {
                                label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            }
                            radioInput.remove();
                        }
                        
                        // Garante que tenha a classe option
                        if (!label.classList.contains('option')) {
                            label.classList.add('option');
                        }

                        // Garante que tenha data-value
                        if (!label.dataset.value) {
                            label.dataset.value = label.textContent.trim();
                        }

                        // Adiciona tesoura se não existir
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) {
                                e.stopPropagation();
                                label.classList.toggle('struck-through');
                            };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });

                    console.log(`🏷️ Card ${cardIndex}: data-topic = "${card.dataset.topic}"`);
                    
                    // Verifica se há opção correta marcada
                    const correctOption = card.querySelector('label[data-answer="true"]');
                    if (correctOption) {
                        console.log(`✅ Opção correta encontrada: "${correctOption.dataset.value}"`);
                    } else {
                        console.log('❌ Nenhuma opção correta encontrada');
                    }
                });
            } else {
                newQuestionsContent.innerHTML = "<p>Não foi possível gerar novas perguntas para os tópicos selecionados.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '✅ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);

        } catch (error) {
            console.error('Erro ao gerar novas perguntas:', error);
            newQuestionsContent.innerHTML = `<p>Erro ao carregar novas perguntas: ${error.message}. Por favor, tente novamente.</p>`;
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '❌ Erro na requisição: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    // Inicialização
    buildQuiz();
    errorDiagnosisSection.style.display = 'none';
    generatedQuestionsSection.style.display = 'none';
    generateNewQuestionsBtn.style.display = 'none';

    // Event listener para o botão de verificar respostas
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
  </script>
</body>
</html>
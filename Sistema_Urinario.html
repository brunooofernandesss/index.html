<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simulado Módulo I - Histologia do Sistema Urinário</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 0;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        background-color: #f4f4f4;
      }

      .quiz-container {
        max-width: 800px;
        width: 100%;
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
      }

      .card {
        background-color: white;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .question {
        font-weight: bold;
        margin-bottom: 10px;
        color: #333;
      }

      .options {
        margin-top: 15px;
      }

      .option {
        display: flex; /* Para alinhar imagem e texto */
        align-items: center;
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        position: relative; /* Para posicionar a tesoura */
      }

      .option:hover {
        background-color: #e9e9e9;
      }

      .option.selected {
        background-color: #d1e7dd;
        border-color: #28a745;
      }

      .option.correct {
        background-color: #d4edda;
        border-color: #28a745;
      }

      .option.incorrect {
        background-color: #f8d7da;
        border-color: #dc3545;
      }

      .submit-btn {
        display: block;
        width: 100%;
        padding: 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 18px;
        cursor: pointer;
        transition: background-color 0.3s ease;
        margin-top: 30px;
      }

      .submit-btn:hover {
        background-color: #0056b3;
      }

      .results {
        text-align: center;
        margin-top: 30px;
        font-size: 20px;
        font-weight: bold;
        color: #333;
      }

      .scissor-icon {
        margin-right: 10px; /* Espaço entre a tesoura e o texto da opção */
        width: 20px; /* Ajuste conforme o tamanho da sua imagem */
        height: 20px; /* Ajuste conforme o tamanho da sua imagem */
        opacity: 0.5; /* Transparência como no original */
        cursor: pointer;
      }

      .scissor-icon.hidden {
        display: none;
      }

      .struck-through {
        text-decoration: line-through;
        color: #888;
      }

      .comment {
        margin-top: 10px;
        padding: 10px;
        background-color: #f0f0f0;
        border-left: 4px solid #007bff;
        font-style: italic;
        color: #555;
        display: none; /* Escondido por padrão */
      }
      .comment.show {
        display: block; /* Mostrado quando ativado */
      }

      /* Estilos para o botão de navegação de erro / diagnóstico */
      .error-nav-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #dc3545; /* Vermelho para erro */
        color: white;
        border: none;
        border-radius: 50%; /* Torna o botão redondo */
        width: 60px;
        height: 60px;
        font-size: 24px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        display: none; /* Escondido por padrão */
        flex-direction: column; /* Para empilhar o ícone e o contador */
        padding: 5px; /* Ajuste o padding para acomodar texto maior */
        box-sizing: border-box; /* Garante que padding não aumente o tamanho total */
        text-align: center;
      }

      .error-nav-btn:hover {
        background-color: #c82333;
      }

      .error-nav-btn .arrow-icon {
        font-size: 30px; /* Tamanho da seta */
        line-height: 1; /* Ajuste para centralizar */
      }

      .error-nav-btn .button-text {
        font-size: 12px; /* Tamanho do texto abaixo da seta */
        line-height: 1;
        margin-top: 2px; /* Espaço entre a seta e o texto */
      }
      
      /* Estilos para a seção de diagnóstico de erros */
      .error-diagnosis-section {
          margin-top: 50px;
          padding: 30px;
          background-color: #ffe0b2; /* Um laranja claro ou similar */
          border-radius: 8px;
          box-shadow: 0 2px 5px rgba(0,0,0,0.15);
          display: none; /* Escondido por padrão */
          text-align: center;
          font-size: 1.1em;
          color: #333;
      }

      .error-diagnosis-section h2 {
          color: #e65100; /* Laranja mais escuro */
          margin-bottom: 20px;
          font-size: 1.8em;
      }

      .error-diagnosis-section ul {
          list-style: none; /* Remove marcadores de lista */
          padding: 0;
          margin: 0;
      }

      .error-diagnosis-section li {
          background-color: #ff9800; /* Laranja */
          color: white;
          padding: 8px 15px;
          margin: 8px 0;
          border-radius: 5px;
          display: inline-block; /* Para que os itens fiquem lado a lado */
          margin-right: 10px;
          font-weight: bold;
      }
      .error-diagnosis-section li:last-child {
          margin-right: 0;
      }
    </style>
  </head>
  <body>
    <div class="quiz-container">
      <h1>Questionário de Múltipla Escolha: Histologia do Sistema Urinário</h1>
      <div id="quiz"></div>
      <button class="submit-btn" id="submit">Verificar Respostas</button>
      <div id="results" class="results"></div>

      <div id="errorDiagnosis" class="error-diagnosis-section">
        <h2>Diagnóstico de Erros</h2>
        <p>Parece que você precisa revisar os seguintes assuntos:</p>
        <ul id="topicsToReview">
          </ul>
      </div>
    </div>

    <button class="error-nav-btn" id="errorNavBtn">
      <span class="arrow-icon"></span> <span class="button-text"></span> </button>

    <script>
      const quizContainer = document.getElementById("quiz");
      const submitButton = document.getElementById("submit");
      const resultsContainer = document.getElementById("results");
      const errorNavBtn = document.getElementById("errorNavBtn");
      const arrowIcon = errorNavBtn.querySelector(".arrow-icon");
      const buttonText = errorNavBtn.querySelector(".button-text");
      const errorDiagnosisSection = document.getElementById("errorDiagnosis");
      const topicsToReviewList = document.getElementById("topicsToReview");

      let wrongQuestionIndices = []; // Array para armazenar os índices das questões marcadas erradas
      let errorCountByTopic = {}; // Objeto para contar erros por tópico (APENAS QUESTÕES MARCADAS ERRADO)
      let totalAnsweredQuestionsByTopic = {}; // Objeto para contar o total de questões RESPONDIDAS por tópico
      let currentWrongQuestionIndex = -1; 
      let hasErrors = false; 
      let isShowingErrors = false; // Flag para controlar se estamos navegando nos erros
      let isShowingDiagnosis = false; // Flag para controlar se estamos na seção de diagnóstico

      const questions = [
        {
          question:
            "1. Qual é a principal função dos rins, conforme abordado pela Dra. Fernanda no início da aula?",
          options: [
            "a) Produção de hormônios sexuais.",
            "b) Digestão de nutrientes.",
            "c) Formação da urina e controle do equilíbrio hidroeletrolítico.",
            "d) Condução de impulsos nervosos.",
          ],
          correctAnswer: "c) Formação da urina e controle do equilíbrio hidroeletrolítico.",
          comment:
            "A Dra. Fernanda enfatizou que a função primordial dos rins é a produção de urina para a excreção de resíduos e, concomitantemente, a regulação do balanço de água e eletrólitos no corpo, mantendo a homeostase.",
          topic: "Função Geral do Rim",
        },
        {
          question:
            "2. Onde o processo inicial de filtração do sangue ocorre nos rins?",
          options: [
            "a) Nos ductos coletores.",
            "b) Nos corpúsculos renais.",
            "c) Na medula renal.",
            "d) Nos ureteres.",
          ],
          correctAnswer: "b) Nos corpúsculos renais.",
          comment:
            "A ultrafiltração glomerular, o primeiro passo na formação da urina, acontece especificamente nos corpúsculos renais, localizados no córtex renal.",
          topic: "Filtração Glomerular",
        },
        {
          question:
            "3. O corpúsculo renal é composto por quais duas estruturas principais?",
          options: [
            "a) Túbulo contorcido proximal e Alça de Henle.",
            "b) Glomérulo e Cápsula de Bowman.",
            "c) Ducto coletor e Túbulo contorcido distal.",
            "d) Arteríola aferente e Veia renal.",
          ],
          correctAnswer: "b) Glomérulo e Cápsula de Bowman.",
          comment:
            "O corpúsculo renal, unidade filtradora inicial, é formado pelo tufo de capilares glomerulares (o glomérulo) envolvido pela Cápsula de Bowman.",
          topic: "Componentes do Corpúsculo Renal",
        },
        {
          question:
            "4. Qual a característica da filtração glomerular destacada pela Dra. Fernanda?",
          options: [
            "a) Permite a passagem de todas as substâncias do sangue.",
            "b) É seletiva, permitindo a passagem de água e pequenas moléculas, mas retendo células sanguíneas e proteínas grandes.",
            "c) Ocorre apenas quando o corpo está desidratado.",
            "d) Depende exclusivamente da atividade hormonal.",
          ],
          correctAnswer: "b) É seletiva, permitindo a passagem de água e pequenas moléculas, mas retendo células sanguíneas e proteínas grandes.",
          comment:
            "A ultrafiltração glomerular é um processo seletivo baseado no tamanho das moléculas e na carga elétrica, impedindo a passagem de elementos figurados do sangue e macromoléculas como as proteínas plasmáticas.",
          topic: "Seletividade da Filtração",
        },
        {
          question:
            "5. Qual segmento do néfron é responsável pela reabsorção da MAIOR parte da água, eletrólitos e nutrientes?",
          options: [
            "a) Alça de Henle.",
            "b) Túbulo contorcido distal.",
            "c) Túbulo contorcido proximal.",
            "d) Ducto coletor.",
          ],
          correctAnswer: "c) Túbulo contorcido proximal.",
          comment:
            "O túbulo contorcido proximal é o local de reabsorção maciça (aproximadamente 65-70%) de água, íons e nutrientes essenciais do filtrado glomerular de volta para o sangue.",
          topic: "Túbulo Contorcido Proximal",
        },
        {
          question:
            "6. As células do túbulo contorcido proximal possuem quais características histológicas que refletem sua intensa atividade de transporte?",
          options: [
            "a) Poucas mitocôndrias e superfície apical lisa.",
            "b) Muitas microvilosidades em borda em escova e muitas mitocôndrias.",
            "c) Epitélio pavimentoso e lúmen amplo.",
            "d) Ausência de canais de transporte.",
          ],
          correctAnswer: "b) Muitas microvilosidades em borda em escova e muitas mitocôndrias.",
          comment:
            "As microvilosidades aumentam a área de superfície para reabsorção, e as numerosas mitocôndrias fornecem a energia (ATP) necessária para os processos de transporte ativo que ocorrem nesse segmento.",
          topic: "Histologia do Túbulo Contorcido Proximal",
        },
        {
          question:
            "7. Qual a principal função da Alça de Henle, conforme explicado na aula?",
          options: [
            "a) Secreção de hormônios.",
            "b) Criação de um gradiente osmótico na medula renal.",
            "c) Reabsorção de glicose e aminoácidos.",
            "d) Armazenamento temporário da urina.",
          ],
          correctAnswer: "b) Criação de um gradiente osmótico na medula renal.",
          comment:
            "A Alça de Henle, com seus segmentos descendente e ascendente, atua como um trocador de contracorrente, estabelecendo um gradiente de concentração crescente na medula renal, essencial para a concentração da urina nos ductos coletores.",
          topic: "Função da Alça de Henle",
        },
        {
          question:
            "8. A permeabilidade à água e aos solutos na Alça de Henle: qual a variação destacada pela Dra. Fernanda?",
          options: [
            "a) O segmento descendente é impermeável à água e permeável a solutos.",
            "b) O segmento ascendente é permeável à água e impermeável a solutos.",
            "c) A permeabilidade varia em cada segmento, contribuindo para o mecanismo de contracorrente.",
            "d) Ambos os segmentos são igualmente permeáveis a água e solutos.",
          ],
          correctAnswer: "c) A permeabilidade varia em cada segmento, contribuindo para o mecanismo de contracorrente.",
          comment:
            "O ramo descendente da Alça de Henle é altamente permeável à água e impermeável a solutos, enquanto o ramo ascendente é impermeável à água e ativamente reabsorve solutos, estabelecendo o gradiente osmótico.",
          topic: "Permeabilidade da Alça de Henle",
        },
        {
          question:
            "9. Qual hormônio influencia a reabsorção de sódio e cálcio e a secreção de potássio e hidrogênio nos túbulos contorcidos distais?",
          options: [
            "a) Insulina.",
            "b) Glucagon.",
            "c) Hormônios (como aldosterona para sódio/potássio e paratormônio para cálcio).",
            "d) Tiroxina.",
          ],
          correctAnswer: "c) Hormônios (como aldosterona para sódio/potássio e paratormônio para cálcio).",
          comment:
            "A reabsorção e secreção nos túbulos distais são finamente reguladas por hormônios, como a aldosterona (reabsorção de sódio e secreção de potássio) e o paratormônio (reabsorção de cálcio), desempenhando papel crucial no balanço hidroeletrolítico e ácido-base.",
          topic: "Túbulo Contorcido Distal e Regulação Hormonal",
        },
        {
          question:
            "10. Onde ocorre o ajuste final da concentração da urina, sob a influência do ADH?",
          options: [
            "a) Nos túbulos contorcidos proximais.",
            "b) Na Cápsula de Bowman.",
            "c) Nos ductos coletores.",
            "d) Nos ureteres.",
          ],
          correctAnswer: "c) Nos ductos coletores.",
          comment:
            "A concentração final da urina é ajustada nos ductos coletores, onde a permeabilidade à água é regulada pelo hormônio antidiurético (ADH). Na presença de ADH, os ductos se tornam permeáveis à água, resultando em urina concentrada.",
          topic: "Ductos Coletores e Concentração da Urina",
        },
        {
          question:
            "11. Que tipo de células revestem as vias urinárias (ureteres, bexiga) e permitem a distensão? ",
          options: [
            "a) Epitélio pavimentoso estratificado.",
            "b) Epitélio colunar simples.",
            "c) Epitélio de transição (urotélio).",
            "d) Epitélio cúbico simples.",
          ],
          correctAnswer: "c) Epitélio de transição (urotélio).",
          comment:
            "O urotélio é um tipo especializado de epitélio estratificado que reveste as vias urinárias desde os cálices renais até a uretra proximal, com a capacidade de se esticar e relaxar conforme o enchimento da bexiga.",
          topic: "Histologia das Vias Urinárias",
        },
        {
          question:
            "12. Qual é a estrutura renal composta por mácula densa, células justaglomerulares e células mesangiais extraglomerulares?",
          options: [
            "a) Corpúsculo renal.",
            "b) Alça de Henle.",
            "c) Aparelho justaglomerular (AJG).",
            "d) Ducto coletor.",
          ],
          correctAnswer: "c) Aparelho justaglomerular (AJG).",
          comment:
            "O aparelho justaglomerular é um complexo especializado que monitora o volume e a composição do filtrado, desempenhando um papel fundamental na regulação da pressão arterial e do volume sanguíneo através da secreção de renina.",
          topic: "Aparelho Justaglomerular (AJG)",
        },
        {
          question:
            "13. Qual a função principal das células justaglomerulares no AJG?",
          options: [
            "a) Reabsorver água.",
            "b) Secretar renina.",
            "c) Filtrar o sangue.",
            "d) Produzir ADH.",
          ],
          correctAnswer: "b) Secretar renina.",
          comment:
            "As células justaglomerulares, localizadas na arteríola aferente, são responsáveis pela produção e secreção de renina em resposta a estímulos como a diminuição da pressão arterial ou da concentração de sódio na mácula densa.",
          topic: "Células Justaglomerulares",
        },
        {
          question:
            "14. A mácula densa, parte do AJG, é uma área especializada de qual segmento do néfron?",
          options: [
            "a) Túbulo contorcido proximal.",
            "b) Alça de Henle.",
            "c) Túbulo contorcido distal.",
            "d) Ducto coletor.",
          ],
          correctAnswer: "c) Túbulo contorcido distal.",
          comment:
            "A mácula densa é uma porção modificada das células do túbulo contorcido distal que se localiza adjacente ao polo vascular do corpúsculo renal e sensoria a concentração de sódio no filtrado.",
          topic: "Mácula Densa",
        },
        {
          question:
            "15. Qual a importância do sistema renina-angiotensina-aldosterona, ativado pelo AJG?",
          options: [
            "a) Regulação da temperatura corporal.",
            "b) Controle da digestão.",
            "c) Controle da pressão arterial e do volume sanguíneo.",
            "d) Produção de glóbulos vermelhos.",
          ],
          correctAnswer: "c) Controle da pressão arterial e do volume sanguíneo.",
          comment:
            "O sistema renina-angiotensina-aldosterona é um dos mecanismos mais importantes para a regulação da pressão arterial e do balanço hidroeletrolítico, com a renina sendo o gatilho inicial.",
          topic: "Sistema Renina-Angiotensina-Aldosterona",
        },
        {
          question:
            "16. Onde os capilares peritubulares e vasos retos (vasa recta) estão localizados e qual sua função?",
          options: [
            "a) No glomérulo, filtrando o sangue.",
            "b) Circundando os túbulos renais, cruciais na troca de substâncias e manutenção do gradiente osmótico.",
            "c) Na medula da adrenal, produzindo hormônios.",
            "d) Na pelve renal, armazenando urina.",
          ],
          correctAnswer: "b) Circundando os túbulos renais, cruciais na troca de substâncias e manutenção do gradiente osmótico.",
          comment:
            "Esses capilares especializados recuperam a água e os solutos reabsorvidos dos túbulos e contribuem para manter o gradiente de concentração medular, essencial para a formação de urina concentrada.",
          topic: "Vascularização Renal",
        },
        {
          question:
            "17. As contrações peristálticas dos ureteres são importantes para qual processo?",
          options: [
            "a) Filtrar o sangue.",
            "b) Impulsionar a urina dos rins para a bexiga.",
            "c) Reabsorver nutrientes.",
            "d) Produzir urina.",
          ],
          correctAnswer: "b) Impulsionar a urina dos rins para a bexiga.",
          comment:
            "A parede muscular dos ureteres, composta por músculo liso, realiza ondas peristálticas que garantem o fluxo unidirecional da urina, impedindo seu refluxo para os rins.",
          topic: "Função dos Ureteres",
        },
        {
          question:
            "18. Qual das seguintes estruturas NÃO faz parte do néfron?",
          options: [
            "a) Corpúsculo renal.",
            "b) Túbulo contorcido proximal.",
            "c) Alça de Henle.",
            "d) Ureter.",
          ],
          correctAnswer: "d) Ureter.",
          comment:
            "O néfron é a unidade funcional do rim, composta pelo corpúsculo renal e seus túbulos associados. O ureter é uma das vias urinárias que transporta a urina do rim para a bexiga.",
          topic: "Componentes do Sistema Urinário",
        },
        {
          question:
            "19. A presença de muitas mitocôndrias nas células tubulares proximais indica:",
          options: [
            "a) Baixa atividade metabólica.",
            "b) Alta demanda energética para transporte ativo.",
            "c) Função de armazenamento de glicogênio.",
            "d) Produção de anticorpos.",
          ],
          correctAnswer: "b) Alta demanda energética para transporte ativo.",
          comment:
            "As mitocôndrias são as 'usinas de energia' da célula. Sua abundância nas células tubulares proximais reflete a intensa atividade de transporte ativo de íons e nutrientes contra gradientes de concentração, o que consome muita energia.",
          topic: "Células Tubulares Proximais",
        },
        {
          question:
            "20. O que aconteceria se a Alça de Henle não conseguisse criar um gradiente osmótico adequado na medula renal?",
          options: [
            "a) A filtração glomerular seria interrompida.",
            "b) A urina não poderia ser adequadamente concentrada ou diluída.",
            "c) A reabsorção de glicose seria comprometida.",
            "d) A pressão arterial aumentaria drasticamente.",
          ],
          correctAnswer: "b) A urina não poderia ser adequadamente concentrada ou diluída.",
          comment:
            "O gradiente osmótico medular é crucial para que os ductos coletores, sob a influência do ADH, possam reabsorver água e produzir uma urina concentrada, ou reter água e produzir uma urina diluída. Sem esse gradiente, a capacidade de concentração/diluição seria perdida.",
          topic: "Gradiente Osmótico Medular",
        },
        {
          question:
            "21. Qual tipo de célula é especializada na filtração do sangue no glomérulo?",
          options: [
            "a) Células mesangiais.",
            "b) Células epiteliais (podócitos) da cápsula de Bowman.",
            "c) Células da mácula densa.",
            "d) Células justaglomerulares.",
          ],
          correctAnswer: "b) Células epiteliais (podócitos) da cápsula de Bowman.",
          comment:
            "Os podócitos são células epiteliais viscerais da cápsula de Bowman com prolongamentos que envolvem os capilares glomerulares, formando fendas de filtração essenciais para o processo de ultrafiltração.",
          topic: "Podócitos e Filtração",
        },
        {
          question:
            "22. A diferença principal entre a uretra masculina e feminina mencionada pela Dra. Fernanda é:",
          options: [
            "a) A uretra feminina possui esfíncter externo, enquanto a masculina não.",
            "b) A uretra masculina é mais curta e com função apenas urinária.",
            "c) A uretra masculina é mais longa e possui função urinária e reprodutora.",
            "d) A uretra feminina é mais longa e com função urinária e reprodutora.",
          ],
          correctAnswer: "c) A uretra masculina é mais longa e possui função urinária e reprodutora.",
          comment:
            "A uretra masculina é significativamente mais longa e serve tanto como via para a urina quanto para o sêmen, enquanto a uretra feminina é mais curta e serve apenas para a urina.",
          topic: "Uretra Masculina e Feminina",
        },
        {
          question:
            "23. Qual camada da parede da bexiga urinária é responsável pela sua capacidade de contração durante a micção?",
          options: [
            "a) Mucosa (urotélio).",
            "b) Submucosa.",
            "c) Camada muscular lisa (músculo detrusor).",
            "d) Adventícia.",
          ],
          correctAnswer: "c) Camada muscular lisa (músculo detrusor).",
          comment:
            "O músculo detrusor, que é a camada muscular lisa da bexiga, contrai-se para expulsar a urina durante a micção.",
          topic: "Histologia da Bexiga",
        },
        {
          question:
            "24. O sistema renina-angiotensina-aldosterona é ativado principalmente em resposta a qual situação?",
          options: [
            "a) Aumento da pressão arterial.",
            "b) Diminuição da pressão arterial ou volume sanguíneo.",
            "c) Aumento do pH sanguíneo.",
            "d) Diminuição dos níveis de glicose.",
          ],
          correctAnswer: "b) Diminuição da pressão arterial ou volume sanguíneo.",
          comment:
            "A secreção de renina pelas células justaglomerulares é estimulada quando há uma queda na pressão arterial ou no volume sanguíneo, ou uma diminuição da concentração de sódio entregue à mácula densa.",
          topic: "Ativação do SRAA",
        },
        {
          question:
            "25. Qual é o papel das células intercalares nos ductos coletores?",
          options: [
            "a) Reabsorção de água exclusivamente.",
            "b) Regulação do balanço ácido-base através da secreção de H+ ou HCO3-.",
            "c) Produção de urina concentrada.",
            "d) Filtração de grandes proteínas.",
          ],
          correctAnswer: "b) Regulação do balanço ácido-base através da secreção de H+ ou HCO3-.",
          comment:
            "As células intercalares, juntamente com as células principais, compõem o epitélio dos ductos coletores e são cruciais para o ajuste fino do pH sanguíneo através da secreção de íons hidrogênio ou bicarbonato.",
          topic: "Células Intercalares",
        },
        {
          question:
            "26. Onde os vasos retos (vasa recta) são mais proeminentes nos rins?",
          options: [
            "a) No córtex renal.",
            "b) Na medula renal.",
            "c) Na cápsula renal.",
            "d) Na pelve renal.",
          ],
          correctAnswer: "b) Na medula renal.",
          comment:
            "Os vasos retos são capilares peritubulares longos e retos que seguem a Alça de Henle profundamente na medula renal, sendo essenciais para manter o gradiente osmótico medular.",
          topic: "Vasa Recta",
        },
        {
          question:
            "27. Qual a principal característica histológica que ajuda a identificar os túbulos contorcidos proximais em uma lâmina?",
          options: [
            "a) Lúmen muito estreito.",
            "b) Epitélio pavimentoso.",
            "c) Presença de borda em escova (microvilosidades).",
            "d) Células com citoplasma claro e poucas organelas.",
          ],
          correctAnswer: "c) Presença de borda em escova (microvilosidades).",
          comment:
            "As microvilosidades apicais formam a 'borda em escova' que é uma característica distintiva do epitélio cúbico simples dos túbulos proximais, refletindo sua vasta área de superfície para reabsorção.",
          topic: "Identificação Histológica: TCP",
        },
        {
          question:
            "28. O que significa dizer que a filtração glomerular é um processo de 'ultrafiltração'?",
          options: [
            "a) Que filtra apenas substâncias muito grandes.",
            "b) Que filtra tudo, exceto as células sanguíneas e grandes proteínas.",
            "c) Que ocorre em velocidade muito lenta.",
            "d) Que é um processo que consome muita energia.",
          ],
          correctAnswer: "b) Que filtra tudo, exceto as células sanguíneas e grandes proteínas.",
          comment:
            "Ultrafiltração refere-se à passagem de água e pequenos solutos através de uma membrana semipermeável sob pressão, retendo componentes maiores como células e proteínas.",
          topic: "Conceito de Ultrafiltração",
        },
        {
          question:
            "29. A Dra. Fernanda mencionou que o rim é dividido em duas regiões principais. Quais são elas?",
          options: [
            "a) Cápsula e Pelve.",
            "b) Glomérulo e Túbulo.",
            "c) Córtex e Medula.",
            "d) Hilio e Seio.",
          ],
          correctAnswer: "c) Córtex e Medula.",
          comment:
            "O parênquima renal é classicamente dividido em uma camada externa, o córtex, e uma camada interna, a medula, cada uma com estruturas histológicas distintas e funções específicas.",
          topic: "Divisão do Rim",
        },
        {
          question:
            "30. Qual das seguintes estruturas é o primeiro segmento do túbulo renal após o corpúsculo renal?",
          options: [
            "a) Túbulo contorcido distal.",
            "b) Alça de Henle.",
            "c) Túbulo contorcido proximal.",
            "d) Ducto coletor.",
          ],
          correctAnswer: "c) Túbulo contorcido proximal.",
          comment:
            "O filtrado sai da cápsula de Bowman e entra diretamente no túbulo contorcido proximal.",
          topic: "Fluxo do Filtrado",
        },
        {
          question:
            "31. O hormônio antidiurético (ADH) atua principalmente em qual segmento do néfron para regular a reabsorção de água?",
          options: [
            "a) Túbulo contorcido proximal.",
            "b) Alça de Henle.",
            "c) Túbulo contorcido distal e Ductos coletores.",
            "d) Cápsula de Bowman.",
          ],
          correctAnswer: "c) Túbulo contorcido distal e Ductos coletores.",
          comment:
            "O ADH aumenta a permeabilidade à água principalmente nos ductos coletores e, em menor grau, nos túbulos contorcidos distais, permitindo a reabsorção de água e a formação de urina concentrada.",
          topic: "Hormônio Antidiurético (ADH)",
        },
        {
          question:
            "32. Qual a principal função da reabsorção nos túbulos renais?",
          options: [
            "a) Eliminar todas as substâncias do corpo.",
            "b) Devolver substâncias úteis ao sangue.",
            "c) Aumentar a quantidade de urina.",
            "d) Produzir hormônios.",
          ],
          correctAnswer: "b) Devolver substâncias úteis ao sangue.",
          comment:
            "A reabsorção é o processo pelo qual a água e os solutos que foram filtrados são recuperados do filtrado tubular e retornam à corrente sanguínea, evitando a perda de substâncias essenciais.",
          topic: "Processos Renais: Reabsorção",
        },
        {
          question:
            "33. Qual a importância do balanço ácido-base para o organismo, com ajuste fino nos túbulos distais e ductos coletores?",
          options: [
            "a) Regulação da temperatura corporal.",
            "b) Manutenção do pH sanguíneo dentro de limites estreitos.",
            "c) Controle da pressão arterial.",
            "d) Reabsorção de glicose.",
          ],
          correctAnswer: "b) Manutenção do pH sanguíneo dentro de limites estreitos.",
          comment:
            "Os rins, através da secreção de íons hidrogênio e reabsorção de bicarbonato nos túbulos distais e ductos coletores, desempenham um papel crucial na regulação do pH sanguíneo, mantendo o equilíbrio ácido-base.",
          topic: "Balanço Ácido-Base",
        },
        {
          question:
            "34. Em termos de identificação histológica, qual segmento tubular geralmente possui um lúmen mais largo e um epitélio sem borda em escova tão proeminente quanto o proximal?",
          options: [
            "a) Túbulo contorcido proximal.",
            "b) Túbulo contorcido distal.",
            "c) Alça de Henle (segmento fino).",
            "d) Ducto coletor.",
          ],
          correctAnswer: "b) Túbulo contorcido distal.",
          comment:
            "Comparado ao túbulo proximal, o túbulo distal possui um lúmen mais amplo, suas células cúbicas são menores e não apresentam a proeminente borda em escova, embora ainda possuam microvilosidades.",
          topic: "Identificação Histológica: TCD",
        },
        {
          question:
            "35. A Dra. Fernanda enfatizou a importância de compreender a microanatomia renal para entender qual processo geral?",
          options: [
            "a) A digestão de alimentos.",
            "b) A formação da urina e a manutenção da homeostase corporal.",
            "c) A contração muscular.",
            "d) A transmissão de sinais nervosos.",
          ],
          correctAnswer: "b) A formação da urina e a manutenção da homeostase corporal.",
          comment:
            "A aula se baseia no princípio de que a estrutura histológica do rim (microanatomia) está diretamente ligada à sua função de filtrar o sangue, formar a urina e manter o equilíbrio interno do corpo (homeostase).",
          topic: "Microanatomia e Função Renal",
        },
        {
          question:
            "36. Qual é a principal característica do urotélio que o torna adequado para revestir a bexiga urinária?",
          options: [
            "a) Ser um epitélio pavimentoso simples.",
            "b) Possuir células ciliadas.",
            "c) Sua capacidade de distensão (plasticidade).",
            "d) Ser altamente vascularizado.",
          ],
          correctAnswer: "c) Sua capacidade de distensão (plasticidade).",
          comment:
            "O urotélio é um epitélio estratificado especializado com a capacidade única de mudar sua forma e espessura conforme o órgão (como a bexiga) se distende ou se contrai.",
          topic: "Urotélio",
        },
        {
          question:
            "37. O que acontece com o filtrado glomerular quando passa pelos ductos coletores na presença de altas concentrações de ADH?",
          options: [
            "a) Fica mais diluído.",
            "b) Não sofre alteração de volume.",
            "c) Fica mais concentrado devido à reabsorção de água.",
            "d) Aumenta seu volume.",
          ],
          correctAnswer: "c) Fica mais concentrado devido à reabsorção de água.",
          comment:
            "O ADH aumenta a inserção de aquaporinas (canais de água) na membrana das células dos ductos coletores, permitindo que a água saia do filtrado e retorne ao sangue, tornando a urina mais concentrada.",
          topic: "ADH e Ductos Coletores",
        },
        {
          question:
            "38. As células que produzem renina no aparelho justaglomerular são células musculares lisas modificadas encontradas em qual arteríola?",
          options: [
            "a) Arteríola eferente.",
            "b) Arteríola aferente.",
            "c) Arteríola interlobar.",
            "d) Arteríola arqueada.",
          ],
          correctAnswer: "b) Arteríola aferente.",
          comment:
            "As células justaglomerulares (produtoras de renina) são encontradas na parede da arteríola aferente, que chega ao glomérulo.",
          topic: "Localização das Células JG",
        },
        {
          question:
            "39. Qual é o papel dos túbulos contorcidos distais na secreção, além da reabsorção?",
          options: [
            "a) Secreção de glicose.",
            "b) Secreção de íons potássio e hidrogênio.",
            "c) Secreção de proteínas plasmáticas.",
            "d) Secreção de células sanguíneas.",
          ],
          correctAnswer: "b) Secreção de íons potássio e hidrogênio.",
          comment:
            "Os túbulos distais são importantes para a secreção de potássio (regulado pela aldosterona) e íons hidrogênio, contribuindo para o balanço de eletrólitos e o controle do pH.",
          topic: "Secreção no TCD",
        },
        {
          question:
            "40. Ao final da aula, a Dra. Fernanda enfatizou a importância de identificar qual estrutura em particular em lâminas histológicas, como um ponto de revisão?",
          options: [
            "a) O baço.",
            "b) A mácula densa.",
            "c) O pâncreas.",
            "d) As glândulas adrenais.",
          ],
          correctAnswer: "b) A mácula densa.",
          comment:
            "A mácula densa é uma estrutura chave do aparelho justaglomerular e sua identificação é um ponto importante para a compreensão da histologia renal e de sua função reguladora.",
          topic: "Identificação Histológica: Mácula Densa",
        },
      ];

      function buildQuiz() {
        const output = [];

        questions.forEach((currentQuestion, questionNumber) => {
          const options = [];
          for (let i = 0; i < currentQuestion.options.length; i++) {
            options.push(
              `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                ${currentQuestion.options[i]}
              </label>`
            );
          }

          output.push(
            `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
              <div class="question">${currentQuestion.question}</div>
              <div class="options">${options.join("")}</div>
              <div class="comment" id="comment-${questionNumber}"></div>
            </div>`
          );
        });

        quizContainer.innerHTML = output.join("");
      }

      function showResults() {
        wrongQuestionIndices = []; 
        errorCountByTopic = {}; // Reseta a contagem de erros por tópico
        totalAnsweredQuestionsByTopic = {}; // Reseta a contagem de questões respondidas por tópico
        currentWrongQuestionIndex = -1; 
        hasErrors = false; 
        isShowingErrors = false; 
        isShowingDiagnosis = false;

        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = ''; 

        const answerContainers = quizContainer.querySelectorAll(".options");
        let correctAnswers = 0;

        questions.forEach((currentQuestion, questionNumber) => {
          const answerContainer = answerContainers[questionNumber];
          const userAnswerElement = answerContainer.querySelector('.option.selected');
          const userAnswerValue = userAnswerElement ? userAnswerElement.dataset.value : undefined;
          const commentDiv = document.getElementById(`comment-${questionNumber}`);

          // Limpa estados anteriores
          const allOptions = answerContainer.querySelectorAll('.option');
          allOptions.forEach(option => {
            option.classList.remove('correct', 'incorrect');
            const scissorIcon = option.querySelector('.scissor-icon');
            if (scissorIcon) scissorIcon.classList.remove('hidden');
          });
          if (commentDiv) commentDiv.classList.remove('show');


          const optionElements = answerContainer.querySelectorAll('.option');
          optionElements.forEach(option => {
            const scissorIcon = option.querySelector('.scissor-icon');

            if (option === userAnswerElement && scissorIcon) {
                scissorIcon.classList.add('hidden');
            } 
            
            if (option.dataset.value === currentQuestion.correctAnswer) {
                option.classList.add('correct');
                if (commentDiv && currentQuestion.comment) {
                    commentDiv.textContent = currentQuestion.comment;
                    commentDiv.classList.add('show');
                }
            }
          });

          // ***************************************************************
          // Lógica crucial: Apenas contabiliza se a questão foi respondida
          // ***************************************************************
          if (userAnswerElement) { // Se o usuário marcou alguma alternativa
            totalAnsweredQuestionsByTopic[currentQuestion.topic] = (totalAnsweredQuestionsByTopic[currentQuestion.topic] || 0) + 1;

            if (userAnswerValue !== currentQuestion.correctAnswer) {
              userAnswerElement.classList.add('incorrect');
              wrongQuestionIndices.push(questionNumber);
              hasErrors = true; 

              // Incrementa o contador de erros para este tópico
              errorCountByTopic[currentQuestion.topic] = (errorCountByTopic[currentQuestion.topic] || 0) + 1;
            } else {
              correctAnswers++;
            }
          }
          // ***************************************************************
          // Fim da lógica crucial
          // ***************************************************************
        });

        resultsContainer.textContent = `Você acertou ${correctAnswers} de ${questions.length} questões.`;
        
        // Rola a página totalmente para baixo para exibir o resultado
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

        if (hasErrors) {
            errorNavBtn.style.display = 'flex';
            arrowIcon.textContent = '⬆️'; // Seta para cima inicialmente
            buttonText.textContent = 'Diagnóstico de Erros'; // Texto claro para diagnóstico
            isShowingErrors = false; // Não estamos navegando erro a erro inicialmente
            isShowingDiagnosis = false; // Ainda não mostramos o diagnóstico
        } else {
            errorNavBtn.style.display = 'none';
        }
      }

      function scrollToQuestion(index) {
        const questionCard = document.getElementById(`question-${index}`);
        if (questionCard) {
          questionCard.scrollIntoView({ behavior: 'smooth', block: 'center' }); 
        }
      }
      
      function scrollToDiagnosis() {
          errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      quizContainer.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');

        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                optionElement.classList.toggle("struck-through");
            } 
            else {
                const questionNumber = optionElement.dataset.question;
                const currentQuestionOptions = quizContainer.querySelectorAll(`.option[data-question=\"${questionNumber}\"]`);
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                
                optionElement.classList.add("selected");
            }
        }
      });

      errorNavBtn.addEventListener("click", function() {
        if (!hasErrors) { // Se não há erros, o botão não deveria estar visível, mas por segurança
            errorNavBtn.style.display = 'none';
            return;
        }

        if (!isShowingErrors && !isShowingDiagnosis) { 
            // Clicou no botão "Diagnóstico de Erros" (seta para cima) para iniciar a navegação ou ir para o diagnóstico
            if (wrongQuestionIndices.length > 0) {
                isShowingErrors = true; // Inicia o modo de navegação de erros
                currentWrongQuestionIndex = 0; // Começa pelo primeiro erro
                arrowIcon.textContent = '⬇️'; // Muda a seta para baixo para navegar pelos erros
                buttonText.textContent = `Próximo Erro (${currentWrongQuestionIndex + 1}/${wrongQuestionIndices.length})`;
                scrollToQuestion(wrongQuestionIndices[currentWrongQuestionIndex]);
            } else {
                // Não há erros para navegar, ir direto para o diagnóstico (embora hasErrors seja falso aqui)
                // Isso é um fallback se hasErrors por algum motivo for true, mas wrongQuestionIndices estiver vazio
                isShowingDiagnosis = true;
                arrowIcon.textContent = '⬆️'; // Seta para cima (já está no final)
                buttonText.textContent = 'Diagnóstico de Erros'; // Texto final
                
                // Preenche e exibe a seção de diagnóstico
                topicsToReviewList.innerHTML = ''; 
                for (const topic in errorCountByTopic) {
                    const errorsInTopic = errorCountByTopic[topic];
                    const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0; // Garante que não é undefined
                    
                    if (totalAnsweredInTopic > 0) { // Evita divisão por zero
                        const percentage = ((errorsInTopic / totalAnsweredInTopic) * 100).toFixed(1); 
                        const li = document.createElement('li');
                        li.textContent = `${topic}: ${percentage}% de erros (${errorsInTopic} de ${totalAnsweredInTopic} questões respondidas)`;
                        topicsToReviewList.appendChild(li);
                    }
                }
                errorDiagnosisSection.style.display = 'block'; 
                scrollToDiagnosis();
                errorNavBtn.style.display = 'none'; // Esconde o botão após ir para o diagnóstico final
            }

        } else if (isShowingErrors) { 
            // Se estamos no modo de navegar pelos erros (botão é "Próximo Erro")
            currentWrongQuestionIndex++;
            if (currentWrongQuestionIndex < wrongQuestionIndices.length) {
                // Ainda há erros para revisar
                scrollToQuestion(wrongQuestionIndices[currentWrongQuestionIndex]);
                buttonText.textContent = `Próximo Erro (${currentWrongQuestionIndex + 1}/${wrongQuestionIndices.length})`;
            } else {
                // Todos os erros foram revisados, agora mostra o diagnóstico
                isShowingErrors = false; 
                isShowingDiagnosis = true;
                arrowIcon.textContent = '⬇️'; // Seta para baixo para o diagnóstico (porque o diagnóstico está no final)
                buttonText.textContent = 'Diagnóstico de Erros'; // Texto final do botão

                // Preenche e exibe a seção de diagnóstico
                topicsToReviewList.innerHTML = ''; 
                for (const topic in errorCountByTopic) {
                    const errorsInTopic = errorCountByTopic[topic];
                    const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
                    
                    if (totalAnsweredInTopic > 0) {
                        const percentage = ((errorsInTopic / totalAnsweredInTopic) * 100).toFixed(1); 
                        const li = document.createElement('li');
                        li.textContent = `${topic}: ${percentage}% de erros (${errorsInTopic} de ${totalAnsweredInTopic} questões respondidas)`;
                        topicsToReviewList.appendChild(li);
                    }
                }
                errorDiagnosisSection.style.display = 'block'; 
                scrollToDiagnosis();
                errorNavBtn.style.display = 'none'; // Esconde o botão após ir para o diagnóstico final
            }
        } 
        // Se isShowingDiagnosis for true, não faz nada ao clicar no botão. Ele já deve ter desaparecido.
      });

      submitButton.addEventListener("click", showResults);

      buildQuiz();
    </script>
  </body>
</html>
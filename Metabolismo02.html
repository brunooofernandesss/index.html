
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Simulado de Metabolismo 02</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      background-color: #f4f4f4;
    }

    .quiz-container {
      max-width: 800px;
      width: 100%;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }

    .card {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .question {
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }

    .options {
      margin-top: 15px;
    }

    /* Estilos unificados para todas as op√ß√µes (est√°ticas e din√¢micas) */
    .option, label.option, label, #newQuestionsContent label {
      display: flex; /* Para alinhar imagem e texto */
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      position: relative; /* Para posicionar a tesoura */
    }

    /* FOR√áA a remo√ß√£o de inputs de radio em QUALQUER lugar */
    .option input[type="radio"], 
    label input[type="radio"],
    #newQuestionsContent input[type="radio"],
    #newQuestionsContent label input[type="radio"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        position: absolute !important;
        left: -9999px !important;
    }

    .option:hover, 
    label.option:hover, 
    label:hover,
    #newQuestionsContent label:hover {
      background-color: #e9e9e9;
    }

    .option.selected, 
    label.option.selected, 
    label.selected,
    #newQuestionsContent label.selected {
      background-color: #d1e7dd;
      border-color: #28a745;
    }

    .option.correct, 
    label.option.correct, 
    label.correct,
    #newQuestionsContent label.correct {
      background-color: #d4edda;
      border-color: #28a745;
    }

    .option.incorrect, 
    label.option.incorrect, 
    label.incorrect,
    #newQuestionsContent label.incorrect {
      background-color: #f8d7da;
      border-color: #dc3545;
    }

    .submit-btn {
      display: block;
      width: 100%;
      padding: 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 30px;
    }

    .submit-btn:hover {
      background-color: #0056b3;
    }

    .results {
      text-align: center;
      margin-top: 30px;
      font-size: 20px;
      font-weight: bold;
      color: #333;
    }

    .scissor-icon {
      margin-right: 10px; /* Espa√ßo entre a tesoura e o texto da op√ß√£o */
      width: 20px; /* Ajuste conforme o tamanho da sua imagem */
      height: 20px; /* Ajuste conforme o tamanho da sua imagem */
      opacity: 0.5; /* Transpar√™ncia como no original */
      cursor: pointer;
    }

    .scissor-icon.hidden {
      display: none;
    }

    .struck-through {
      text-decoration: line-through;
      color: #888;
    }

    .comment {
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f0f0;
      border-left: 4px solid #007bff;
      font-style: italic;
      color: #555;
      display: none; /* Escondido por padr√£o */
    }
    .comment.show {
      display: block; /* Mostrado quando ativado */
    }

    /* Estilos para o bot√£o de navega√ß√£o de erro / diagn√≥stico */
    .error-nav-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #dc3545; /* Vermelho para erro */
      color: white;
      border: none;
      border-radius: 50%; /* Torna o bot√£o redondo */
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      display: none; /* Escondido por padr√£o */
      flex-direction: column; /* Para empilhar o √≠cone e o contador */
      padding: 5px; /* Ajuste o padding para acomodar texto maior */
      box-sizing: border-box; /* Garante que padding n√£o aumente o tamanho total */
      text-align: center;
    }

    .error-nav-btn:hover {
      background-color: #c82333;
    }

    .error-nav-btn .arrow-icon {
      font-size: 30px; /* Tamanho da seta */
      line-height: 1; /* Ajuste para centralizar */
    }

    .error-nav-btn .button-text {
      font-size: 12px; /* Tamanho do texto abaixo da seta */
      line-height: 1;
      margin-top: 2px; /* Espa√ßo entre a seta e o texto */
    }

    /* Estilos para a se√ß√£o de diagn√≥stico de erros */
    .error-diagnosis-section {
        margin-top: 50px;
        padding: 30px;
        background-color: #ffe0b2; /* Um laranja claro ou similar */
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        display: none; /* Escondido por padr√£o */
        text-align: center;
        font-size: 1.1em;
        color: #333;
    }

    .error-diagnosis-section h2 {
        color: #e65100; /* Laranja mais escuro */
        margin-bottom: 20px;
        font-size: 1.8em;
    }

    .error-diagnosis-section ul {
        list-style: none; /* Remove marcadores de lista */
        padding: 0;
        margin: 0;
    }

    .error-diagnosis-section li {
        background-color: #ff9800; /* Laranja */
        color: white;
        padding: 8px 15px;
        margin: 8px 0;
        border-radius: 5px;
        display: inline-block; /* Para que os itens fiquem lado a lado */
        margin-right: 10px;
        font-weight: bold;
    }
    .error-diagnosis-section li:last-child {
        margin-right: 0;
    }
 .card-bloco {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      background: #fff;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1 style="text-align:center; margin-bottom: 30px;">Simulado de Metabolismo 02</h1>
    <div class="card-bloco" id="quiz"></div>
    <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>

    <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">
      Gerar Novas Perguntas
    </button>

    <div class="results card-bloco" id="results"></div>
    <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>

    <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
      <h2>Diagn√≥stico de Erros</h2>
      <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
      <ul id="topicsToReview"></ul>
    </div>

    <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
      <h2>Novas Perguntas Geradas</h2>
      <div id="newQuestionsContent"></div>
    </div>
  </div>
  
  <button class="error-nav-btn" id="errorNavBtn" style="display:none;">
    <span class="arrow-icon"></span>
    <span class="button-text"></span>
  </button>

  <script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorNavBtn = document.getElementById("errorNavBtn");
    const arrowIcon = errorNavBtn.querySelector(".arrow-icon");
    const buttonText = errorNavBtn.querySelector(".button-text");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};
    let totalAnsweredQuestionsByTopic = {};
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;
    let isShowingErrors = false;
    let isShowingDiagnosis = false;

    // Inicializa a visibilidade das se√ß√µes no carregamento
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    const questions = [       {         question: "1. A desnatura√ß√£o de uma prote√≠na √© um processo que altera sua estrutura, mas mant√©m intacta a sua sequ√™ncia de amino√°cidos. Qual dos seguintes fatores √© mencionado como causa da desnatura√ß√£o?",         options: [           "a) Calor e quebra de liga√ß√µes pept√≠dicas.",           "b) Mudan√ßa brusca de pH e aumento da agita√ß√£o molecular.",           "c) Hidr√≥lise e liga√ß√µes covalentes.",           "d) Frio e alcalose metab√≥lica.",         ],         correctAnswer: "b) Mudan√ßa brusca de pH e aumento da agita√ß√£o molecular.",         comment: "A desnatura√ß√£o √© um processo que desdobra a prote√≠na de sua forma nativa, sendo causado por fatores como o aumento da agita√ß√£o molecular devido ao calor ou altera√ß√µes no pH. As liga√ß√µes pept√≠dicas n√£o s√£o quebradas na desnatura√ß√£o, mas sim na hidr√≥lise.",         topic: "Desnatura√ß√£o de Prote√≠nas",       },       {         question: "2. Qual a principal caracter√≠stica das enzimas, conforme descrito na aula?",         options: [           "a) S√£o carboidratos que armazenam energia.",           "b) S√£o lip√≠dios que formam barreiras de prote√ß√£o.",           "c) S√£o prote√≠nas que atuam como catalisadores biol√≥gicos, acelerando rea√ß√µes.",           "d) S√£o √°cidos nucleicos que carregam informa√ß√µes gen√©ticas.",         ],         correctAnswer: "c) S√£o prote√≠nas que atuam como catalisadores biol√≥gicos, acelerando rea√ß√µes.",         comment: "O Dr. Marcelo menciona explicitamente que as enzimas s√£o prote√≠nas com a fun√ß√£o de catalisadores biol√≥gicos, acelerando as rea√ß√µes qu√≠micas no corpo.",         topic: "Enzimas e Cat√°lise",       },       {         question: "3. O que acontece com as liga√ß√µes pept√≠dicas durante o processo de desnatura√ß√£o de uma prote√≠na?",         options: [           "a) Elas s√£o quebradas, resultando em amino√°cidos.",           "b) Elas s√£o fortalecidas, mantendo a estrutura da prote√≠na.",           "c) Elas permanecem intactas, mas a prote√≠na perde sua forma nativa.",           "d) Elas se transformam em liga√ß√µes de hidrog√™nio.",         ],         correctAnswer: "c) Elas permanecem intactas, mas a prote√≠na perde sua forma nativa.",         comment: "A desnatura√ß√£o √© uma altera√ß√£o na forma da prote√≠na (enovelamento), mas n√£o rompe as liga√ß√µes pept√≠dicas. A quebra dessas liga√ß√µes √© caracter√≠stica da hidr√≥lise.",         topic: "Desnatura√ß√£o e Liga√ß√µes Qu√≠micas",       },       {         question: "4. A hidr√≥lise de uma prote√≠na, que a divide em peda√ßos menores, √© conhecida como qual tipo de rea√ß√£o?",         options: [           "a) Rea√ß√£o de condensa√ß√£o.",           "b) Rea√ß√£o de desnatura√ß√£o.",           "c) Rea√ß√£o de oxida√ß√£o.",           "d) Rea√ß√£o de quebra (lise).",         ],         correctAnswer: "d) Rea√ß√£o de quebra (lise).",         comment: "A hidr√≥lise √© o processo de quebra das liga√ß√µes pept√≠dicas das prote√≠nas. O termo 'lise' significa quebra, e a aula a diferencia da desnatura√ß√£o.",         topic: "Hidr√≥lise de Prote√≠nas",       },       {         question: "5. Qual a fun√ß√£o de um cofator ou coenzima na atividade enzim√°tica?",         options: [           "a) Desnaturar a enzima para torn√°-la mais eficiente.",           "b) Fornecer energia diretamente para a rea√ß√£o.",           "c) Ajudar a enzima a desempenhar seu trabalho, auxiliando em sua conforma√ß√£o.",           "d) Se ligar ao substrato para inibir a rea√ß√£o.",         ],         correctAnswer: "c) Ajudar a enzima a desempenhar seu trabalho, auxiliando em sua conforma√ß√£o.",         comment: "Cofatores e coenzimas s√£o subst√¢ncias que auxiliam a atividade enzim√°tica, complementando sua estrutura para que possam atuar.",         topic: "Cofatores e Coenzimas",       },       {         question: "6. Como a energia que nos mant√©m vivos √© obtida, segundo a aula?",         options: [           "a) Diretamente do calor do sol.",           "b) Roubando energia de outros animais.",           "c) Da energia qu√≠mica contida nas liga√ß√µes dos alimentos, que originalmente vem do sol.",           "d) Da energia liberada na respira√ß√£o.",         ],         correctAnswer: "c) Da energia qu√≠mica contida nas liga√ß√µes dos alimentos, que originalmente vem do sol.",         comment: "A aula explica que os vegetais capturam a energia solar por meio da fotoss√≠ntese e a armazenam em liga√ß√µes qu√≠micas. N√≥s, ao nos alimentarmos, consumimos essa energia.",         topic: "Energia e Metabolismo",       },       {         question: "7. Quais s√£o os dois tipos de metabolismo mencionados, que est√£o interconectados?",         options: [           "a) Respira√ß√£o e Digest√£o.",           "b) Catabolismo e Anabolismo.",           "c) S√≠ntese e Absor√ß√£o.",           "d) Oxida√ß√£o e Redu√ß√£o.",         ],         correctAnswer: "b) Catabolismo e Anabolismo.",         comment: "O metabolismo √© um conjunto de rea√ß√µes que se dividem em catabolismo (quebra) e anabolismo (constru√ß√£o). O catabolismo fornece a energia para o anabolismo.",         topic: "Tipos de Metabolismo",       },       {         question: "8. Qual das seguintes afirma√ß√µes sobre catabolismo est√° correta?",         options: [           "a) √â a constru√ß√£o de mol√©culas complexas a partir de mol√©culas menores.",           "b) √â um processo que consome energia (endot√©rmico).",           "c) √â uma rea√ß√£o de quebra que libera energia (exot√©rmica).",           "d) √â um processo que s√≥ acontece quando h√° falta de oxig√™nio.",         ],         correctAnswer: "c) √â uma rea√ß√£o de quebra que libera energia (exot√©rmica).",         comment: "O catabolismo √© o processo de degrada√ß√£o de mol√©culas e √© caracterizado por liberar energia, sendo portanto uma rea√ß√£o exot√©rmica.",         topic: "Catabolismo",       },       {         question: "9. A mol√©cula de ATP √© comparada a uma 'pilha' ou 'bateria'. Qual o processo que 'carrega' essa mol√©cula?",         options: [           "a) Desnatura√ß√£o.",           "b) Hidr√≥lise.",           "c) Fosforila√ß√£o.",           "d) Fermenta√ß√£o.",         ],         correctAnswer: "c) Fosforila√ß√£o.",         comment: "O Dr. Marcelo explica que a fosforila√ß√£o √© o processo de adi√ß√£o de um fosfato ao ADP, convertendo-o em ATP, que armazena energia.",         topic: "ATP e Fosforila√ß√£o",       },       {         question: "10. Qual a principal enzima envolvida na digest√£o de amido na boca e qual o seu destino no est√¥mago?",         options: [           "a) Lactase, que √© ativada no est√¥mago.",           "b) Sacarase, que √© desnaturada no est√¥mago.",           "c) Amilase, que √© desnaturada no est√¥mago.",           "d) Maltase, que √© ativada no est√¥mago.",         ],         correctAnswer: "c) Amilase, que √© desnaturada no est√¥mago.",         comment: "A digest√£o do amido come√ßa na boca com a amilase, mas a enzima √© desnaturada pelo pH √°cido do est√¥mago, parando sua a√ß√£o.",         topic: "Digest√£o de Carboidratos",       },       {         question: "11. Qual √© o produto final da digest√£o completa de carboidratos, como amido e lactose, no intestino?",         options: [           "a) Pept√≠deos e amino√°cidos.",           "b) Maltose e sacarose.",           "c) Glicose, frutose e galactose (monossacar√≠deos).",           "d) Ceto√°cidos e lactato.",         ],         correctAnswer: "c) Glicose, frutose e galactose (monossacar√≠deos).",         comment: "O Dr. Marcelo explica que a digest√£o de amido, lactose e sacarose resulta, respectivamente, em monossacar√≠deos: glicose, glicose+frutose e glicose+galactose.",         topic: "Produtos da Digest√£o de Carboidratos",       },       {         question: "12. A intoler√¢ncia √† lactose ocorre devido a que fator, de acordo com a aula?",         options: [           "a) Falta da enzima amilase.",           "b) Produ√ß√£o excessiva de lactase.",           "c) Defici√™ncia ou inefici√™ncia da enzima lactase no intestino.",           "d) Desnatura√ß√£o da sacarase no est√¥mago.",         ],         correctAnswer: "c) Defici√™ncia ou inefici√™ncia da enzima lactase no intestino.",         comment: "A intoler√¢ncia √† lactose √© causada pela incapacidade de quebrar a lactose, que √© devido √† aus√™ncia ou inefic√°cia da enzima lactase.",         topic: "Intoler√¢ncia √† Lactose",       },       {         question: "13. A glic√≥lise √© o processo metab√≥lico que converte uma mol√©cula de glicose em quantas mol√©culas de piruvato?",         options: [           "a) 1.",           "b) 2.",           "c) 3.",           "d) 4.",         ],         correctAnswer: "b) 2.",         comment: "O Dr. Marcelo menciona que a glic√≥lise transforma uma mol√©cula de glicose em duas mol√©culas de piruvato.",         topic: "Glic√≥lise",       },       {         question: "14. Qual o saldo l√≠quido de ATPs gerado na glic√≥lise, ap√≥s considerar o gasto inicial de energia?",         options: [           "a) 4 ATPs.",           "b) 1 ATP.",           "c) 2 ATPs.",           "d) 0 ATPs.",         ],         correctAnswer: "c) 2 ATPs.",         comment: "Embora a glic√≥lise produza 4 ATPs, h√° um consumo inicial de 2 ATPs, resultando em um saldo l√≠quido de 2.",         topic: "Balan√ßo Energ√©tico da Glic√≥lise",       },       {         question: "15. Qual mol√©cula √© descrita como um 'caminh√£o de frete' que transporta hidrog√™nios e el√©trons durante a glic√≥lise?",         options: [           "a) GTP.",           "b) FADH2.",           "c) ATP.",           "d) NAD+.",         ],         correctAnswer: "d) NAD+.",         comment: "O Dr. Marcelo usa essa analogia para explicar a fun√ß√£o da NAD+, que √© transportadora de hidrog√™nios e el√©trons nas rea√ß√µes metab√≥licas.",         topic: "NAD+ como Transportador",       },       {         question: "16. A fermenta√ß√£o l√°tica ocorre quando h√° aus√™ncia ou baixa quantidade de qual subst√¢ncia?",         options: [           "a) Glicose.",           "b) Piruvato.",           "c) Lactato.",           "d) Oxig√™nio.",         ],         correctAnswer: "d) Oxig√™nio.",         comment: "A fermenta√ß√£o l√°tica √© apresentada como uma via alternativa para o piruvato quando o oxig√™nio n√£o √© suficiente para a respira√ß√£o celular aer√≥bica.",         topic: "Fermenta√ß√£o L√°tica",       },       {         question: "17. O que acontece com o NADH gerado na glic√≥lise durante a fermenta√ß√£o l√°tica?",         options: [           "a) Ele √© consumido para produzir ATP.",           "b) Ele √© usado para regenerar o NAD+.",           "c) Ele √© convertido em lactato.",           "d) Ele √© levado para a cadeia respirat√≥ria.",         ],         correctAnswer: "b) Ele √© usado para regenerar o NAD+.",         comment: "Na fermenta√ß√£o l√°tica, o NADH doa seus hidrog√™nios para o piruvato, transformando-o em lactato e regenerando o NAD+ para que a glic√≥lise continue.",         topic: "Regenera√ß√£o de NAD+",       },       {         question: "18. O processo de gliconeog√™nese √© a s√≠ntese de uma nova glicose a partir de subst√¢ncias que n√£o s√£o carboidratos. Qual a subst√¢ncia pode ser reciclada em glicose, segundo a aula?",         options: [           "a) Lactato.",           "b) Lip√≠dios.",           "c) √Åcidos graxos.",           "d) ATP.",         ],         correctAnswer: "a) Lactato.",         comment: "O lactato, res√≠duo da fermenta√ß√£o l√°tica, pode ser levado ao f√≠gado para ser transformado novamente em glicose atrav√©s da gliconeog√™nese.",         topic: "Gliconeog√™nese",       },       {         question: "19. A via das pentoses, al√©m de gerar ribose, produz uma mol√©cula importante para o metabolismo de lip√≠dios. Que mol√©cula √© essa?",         options: [           "a) FAD.",           "b) ADP.",           "c) ATP.",           "d) NADPH.",         ],         correctAnswer: "d) NADPH.",         comment: "A aula menciona que a via das pentoses produz NADPH, uma mol√©cula que, ao contr√°rio do NADH, participa do metabolismo de lip√≠dios.",         topic: "Via das Pentoses",       },       {         question: "20. A energia que originalmente vem do sol √© capturada pelos vegetais atrav√©s de qual processo?",         options: [           "a) Glic√≥lise.",           "b) Gliconeog√™nese.",           "c) Fermenta√ß√£o.",           "d) Fotoss√≠ntese.",         ],         correctAnswer: "d) Fotoss√≠ntese.",         comment: "√â a fotoss√≠ntese o processo pelo qual os vegetais captam a energia luminosa do sol e a convertem em energia qu√≠mica.",         topic: "Fotoss√≠ntese",       },       {         question: "21. A energia liberada no catabolismo √© armazenada principalmente na forma de qual mol√©cula?",         options: [           "a) Glicose.",           "b) DNA.",           "c) Prote√≠na.",           "d) ATP.",         ],         correctAnswer: "d) ATP.",         comment: "O Dr. Marcelo afirma que a energia liberada nas rea√ß√µes catab√≥licas √© armazenada em mol√©culas, principalmente o ATP.",         topic: "Armazenamento de Energia",       },       {         question: "22. O que a aula menciona sobre a natureza das vias metab√≥licas em nosso corpo?",         options: [           "a) Elas ocorrem uma de cada vez.",           "b) Elas ocorrem 100% o tempo todo e nunca param.",           "c) Elas se intensificam ou diminuem sua velocidade, mas n√£o param completamente.",           "d) Elas s√£o desativadas quando n√£o h√° necessidade de energia.",         ],         correctAnswer: "c) Elas se intensificam ou diminuem sua velocidade, mas n√£o param completamente.",         comment: "O Dr. Marcelo explica que todas as vias funcionam 24 horas por dia, embora com intensidades diferentes, e que n√£o existe processo que pare por completo em um ser vivo.",         topic: "Din√¢mica das Vias Metab√≥licas",       },       {         question: "23. Por que a fermenta√ß√£o l√°tica n√£o √© considerada 'interessante' do ponto de vista energ√©tico para a c√©lula?",         options: [           "a) Porque ela consome mais ATP do que produz.",           "b) Porque n√£o produz ATP ou produz uma quantidade m√≠nima em compara√ß√£o a outras vias.",           "c) Porque ela produz res√≠duos t√≥xicos para o corpo.",           "d) Porque ela causa a desnatura√ß√£o de prote√≠nas.",         ],         correctAnswer: "b) Porque n√£o produz ATP ou produz uma quantidade m√≠nima em compara√ß√£o a outras vias.",         comment: "A fermenta√ß√£o l√°tica n√£o gera ATP, e seu prop√≥sito √© apenas regenerar o NAD+ para que a glic√≥lise continue, produzindo o saldo de 2 ATPs.",         topic: "Efici√™ncia Energ√©tica da Fermenta√ß√£o L√°tica",       },       {         question: "24. O que √© o ciclo de Cori, conforme descrito na aula?",         options: [           "a) O processo de quebra de prote√≠nas em amino√°cidos.",           "b) A via metab√≥lica onde a glicose √© convertida em piruvato.",           "c) A reciclagem do lactato, onde ele √© convertido em glicose pelo f√≠gado e retorna ao m√∫sculo.",           "d) A produ√ß√£o de ATP na cadeia respirat√≥ria.",         ],         correctAnswer: "c) A reciclagem do lactato, onde ele √© convertido em glicose pelo f√≠gado e retorna ao m√∫sculo.",         comment: "O Dr. Marcelo explica que o ciclo de Cori √© a via onde o lactato √© reciclado pelo f√≠gado e transformado em glicose.",         topic: "Ciclo de Cori",       },       {         question: "25. Qual √© a mol√©cula que se liga ao lactato e o transforma de volta em piruvato, de acordo com o mapa metab√≥lico apresentado?",         options: [           "a) NAD+.",           "b) ATP.",           "c) NADH.",           "d) GDP.",         ],         correctAnswer: "a) NAD+.",         comment: "A aula mostra que a NAD+ entra vazia e, ao receber os hidrog√™nios do lactato, o converte em piruvato, regenerando-se em NADH.",         topic: "Convers√£o de Lactato para Piruvato",       },       {         question: "26. A gliconeog√™nese √© um processo anab√≥lico, o que significa que:",         options: [           "a) Ele gera energia em forma de ATP.",           "b) Ele consome energia.",           "c) Ele quebra mol√©culas grandes em pequenas.",           "d) Ele s√≥ ocorre na aus√™ncia de oxig√™nio.",         ],         correctAnswer: "b) Ele consome energia.",         comment: "A gliconeog√™nese √© um processo de constru√ß√£o de glicose (anabolismo) a partir de outras mol√©culas, e como todo processo anab√≥lico, ele consome energia.",         topic: "Gliconeog√™nese como Processo Anab√≥lico",       },       {         question: "27. Qual a principal enzima que controla a velocidade da glic√≥lise, referida como 'enzima marca-passo'?",         options: [           "a) Lactase.",           "b) Amilase.",           "c) Fosfofrutoquinase (PFK).",           "d) ATP sintase.",         ],         correctAnswer: "c) Fosfofrutoquinase (PFK).",         comment: "O Dr. Marcelo menciona a fosfofrutoquinase como a enzima que controla a velocidade dessa via.",         topic: "Enzima Marca-Passo da Glic√≥lise",       },       {         question: "28. A baixa quantidade de ATP estimula a fosfofrutoquinase (PFK) para que a glic√≥lise aconte√ßa mais rapidamente. O que acontece quando h√° excesso de ATP?",         options: [           "a) A PFK √© inibida e a glic√≥lise diminui a velocidade.",           "b) A PFK √© estimulada para produzir mais ATP.",           "c) A glic√≥lise continua na mesma velocidade.",           "d) A c√©lula passa a usar a via das pentoses.",         ],         correctAnswer: "a) A PFK √© inibida e a glic√≥lise diminui a velocidade.",         comment: "A aula explica que se h√° excesso de ATP, o corpo n√£o precisa de mais energia, ent√£o a enzima marca-passo (PFK) da glic√≥lise √© inibida para diminuir a velocidade da via.",         topic: "Regula√ß√£o da Glic√≥lise",       },       {         question: "29. O que acontece com a glicose que n√£o √© utilizada imediatamente para a produ√ß√£o de energia?",         options: [           "a) √â eliminada como lixo metab√≥lico.",           "b) √â guardada na forma de glicog√™nio no f√≠gado e nos m√∫sculos.",           "c) √â convertida em lactato.",           "d) √â convertida em ribose na via das pentoses.",         ],         correctAnswer: "b) √â guardada na forma de glicog√™nio no f√≠gado e nos m√∫sculos.",         comment: "O glicog√™nio √© a forma de armazenamento da glicose para uso posterior, que ocorre principalmente no f√≠gado e nos m√∫sculos.",         topic: "Armazenamento de Glicose",       },       {         question: "30. Na via das pentoses, a glicose √© convertida em um a√ß√∫car de cinco carbonos (pentose), que √© a ribose. Por que a ribose √© importante?",         options: [           "a) Para a produ√ß√£o de energia na cadeia respirat√≥ria.",           "b) Para a s√≠ntese de √°cidos nucleicos e ATP.",           "c) Para ser reciclada e formar glicose novamente.",           "d) Para a fermenta√ß√£o l√°tica em c√©lulas musculares.",         ],         correctAnswer: "b) Para a s√≠ntese de √°cidos nucleicos e ATP.",         comment: "A ribose √© um a√ß√∫car fundamental para a estrutura do DNA, RNA e ATP.",         topic: "Import√¢ncia da Ribose",       },       {         question: "31. Qual a mol√©cula que transporta hidrog√™nios no metabolismo de lip√≠dios, produzida na via das pentoses?",         options: [           "a) NAD+.",           "b) FAD+.",           "c) NADPH.",           "d) ATP.",         ],         correctAnswer: "c) NADPH.",         comment: "O Dr. Marcelo diferencia o NADH do NADPH, mencionando que este √∫ltimo √© produzido na via das pentoses e participa do metabolismo de lip√≠dios.",         topic: "NADPH no Metabolismo de Lip√≠dios",       },       {         question: "32. Qual a via metab√≥lica da glicose que ocorre no citosol da c√©lula?",         options: [           "a) Glic√≥lise.",           "b) Ciclo de Krebs.",           "c) Cadeia respirat√≥ria.",           "d) Fermenta√ß√£o alco√≥lica.",         ],         correctAnswer: "a) Glic√≥lise.",         comment: "A aula menciona que a glic√≥lise √© a via que ocorre no citosol (citoplasma) da c√©lula.",         topic: "Localiza√ß√£o da Glic√≥lise",       },       {         question: "33. Qual a principal diferen√ßa, em termos de gasto ou produ√ß√£o de energia, entre o catabolismo e o anabolismo?",         options: [           "a) O catabolismo gasta energia, e o anabolismo a produz.",           "b) O anabolismo gasta energia, e o catabolismo a produz.",           "c) Ambos os processos produzem energia.",           "d) Ambos os processos gastam energia.",         ],         correctAnswer: "b) O anabolismo gasta energia, e o catabolismo a produz.",         comment: "O catabolismo (quebra) √© exot√©rmico e libera energia, enquanto o anabolismo (constru√ß√£o) √© endot√©rmico e consome energia.",         topic: "Diferen√ßa entre Catabolismo e Anabolismo",       },       {         question: "34. Por que a lactase, enzima que digere a lactose, √© considerada espec√≠fica?",         options: [           "a) Porque ela s√≥ funciona em pH neutro.",           "b) Porque ela s√≥ atua sobre a mol√©cula de lactose, quebrando-a em glicose e galactose.",           "c) Porque ela s√≥ √© produzida quando h√° falta de oxig√™nio.",           "d) Porque ela √© um catalisador universal para todos os carboidratos.",         ],         correctAnswer: "b) Porque ela s√≥ atua sobre a mol√©cula de lactose, quebrando-a em glicose e galactose.",         comment: "A especificidade de uma enzima, conforme a analogia da chave e fechadura, significa que ela atua sobre um √∫nico substrato. A lactase, por exemplo, atua somente na lactose.",         topic: "Especificidade das Enzimas",       },       {         question: "35. A quebra completa da sacarose pela sacarase resulta em quais monossacar√≠deos?",         options: [           "a) Glicose e glicose.",           "b) Frutose e frutose.",           "c) Glicose e frutose.",           "d) Glicose e galactose.",         ],         correctAnswer: "c) Glicose e frutose.",         comment: "A aula detalha que a sacarose √© um dissacar√≠deo composto por glicose e frutose.",         topic: "Quebra da Sacarose",       },       {         question: "36. Por que o jejum prolongado √© mencionado na aula em rela√ß√£o √† gliconeog√™nese?",         options: [           "a) Porque intensifica o processo de gliconeog√™nese para produzir glicose a partir de outras subst√¢ncias.",           "b) Porque o corpo para de produzir glicose.",           "c) Porque o corpo passa a quebrar glicog√™nio.",           "d) Porque o corpo aumenta o consumo de glicose.",         ],         correctAnswer: "a) Porque intensifica o processo de gliconeog√™nese para produzir glicose a partir de outras subst√¢ncias.",         comment: "Em per√≠odos de jejum, a via da gliconeog√™nese √© ativada para que o corpo possa continuar produzindo glicose para suas necessidades energ√©ticas.",         topic: "Jejum e Gliconeog√™nese",       },       {         question: "37. Qual a fun√ß√£o da insulina no metabolismo da glicose?",         options: [           "a) Quebrar a glicose em piruvato.",           "b) Estimular a produ√ß√£o de ATP.",           "c) Ajudar a glicose a entrar nas c√©lulas.",           "d) Converter glicose em glicog√™nio.",         ],         correctAnswer: "c) Ajudar a glicose a entrar nas c√©lulas.",         comment: "A insulina √© o horm√¥nio que estimula a prote√≠na transportadora (GLUT4) para que a glicose adentre a c√©lula, onde ser√° metabolizada.",         topic: "Insulina e Glicose",       },       {         question: "38. Na via das pentoses, o que acontece com o excesso de ribulose que n√£o √© usado para a s√≠ntese de outras mol√©culas?",         options: [           "a) √â eliminado do corpo.",           "b) √â transformado de volta em glicose.",           "c) √â reciclado em subst√¢ncias como frutose e gliceralde√≠do para a glic√≥lise.",           "d) √â armazenado como glicog√™nio.",         ],         correctAnswer: "c) √â reciclado em subst√¢ncias como frutose e gliceralde√≠do para a glic√≥lise.",         comment: "A aula descreve um sistema de reciclagem na via das pentoses, onde a ribulose excedente pode ser convertida em intermedi√°rios da glic√≥lise para gerar energia.",         topic: "Reciclagem de Ribulose",       },       {         question: "39. O que acontece com a NAD+ na fermenta√ß√£o l√°tica?",         options: [           "a) Ela √© consumida e n√£o pode ser regenerada.",           "b) Ela √© convertida em lactato.",           "c) Ela √© regenerada a partir de NADH.",           "d) Ela √© transportada para a cadeia respirat√≥ria.",         ],         correctAnswer: "c) Ela √© regenerada a partir de NADH.",         comment: "O NADH transfere seus hidrog√™nios para o piruvato para formar lactato, e o NAD+ √© regenerado para ser utilizado em novas rodadas de glic√≥lise.",         topic: "Papel do NAD+ na Fermenta√ß√£o L√°tica",       },       {         question: "40. O que significa uma enzima ser um catalisador biol√≥gico?",         options: [           "a) Ela √© a √∫nica respons√°vel por iniciar a rea√ß√£o.",           "b) Ela aumenta a velocidade de uma rea√ß√£o sem ser consumida no processo.",           "c) Ela atua como um reagente na rea√ß√£o.",           "d) Ela √© inibida pela presen√ßa de substrato.",         ],         correctAnswer: "b) Ela aumenta a velocidade de uma rea√ß√£o sem ser consumida no processo.",         comment: "O Dr. Marcelo define um catalisador como uma subst√¢ncia que acelera uma rea√ß√£o, e as enzimas se encaixam nessa defini√ß√£o no contexto biol√≥gico.",         topic: "Catalisadores Biol√≥gicos",       },     ];

    function buildQuiz() {
      const output = [];

      questions.forEach((currentQuestion, questionNumber) => {
        const options = [];
        for (let i = 0; i < currentQuestion.options.length; i++) {
          options.push(
            `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
              <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
              ${currentQuestion.options[i]}
            </label>`
          );
        }

        output.push(
          `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
            <div class="question">${currentQuestion.question}</div>
            <div class="options">${options.join("")}</div>
            <div class="comment" id="comment-${questionNumber}"></div>
          </div>`
        );
      });

      quizContainer.innerHTML = output.join("");
    }

    function showResults() {
      wrongQuestionIndices = [];
      errorCountByTopic = {};
      totalAnsweredQuestionsByTopic = {};
      currentWrongQuestionIndex = -1;
      hasErrors = false;
      isShowingErrors = false;
      isShowingDiagnosis = false;

      errorDiagnosisSection.style.display = 'none';
      topicsToReviewList.innerHTML = '';
      statusMessage.textContent = '';

      // Busca por todas as perguntas: est√°ticas e din√¢micas
      const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
      let correctAnswersCount = 0;
      let totalQuestionsAnswered = 0;

      console.log('üîç Verificando', allQuestionCards.length, 'perguntas...');

      allQuestionCards.forEach((card, index) => {
        const questionEl = card.querySelector('.question') || card.querySelector('p');
        if (!questionEl) return;

        const questionText = questionEl.textContent.trim();
        const optionsContainer = card.querySelector('.options') || card;
        const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
        const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
        const commentDiv = card.querySelector('.comment');

        const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";
        
        console.log(`üìù Pergunta ${index + 1}: T√≥pico = "${questionTopic}"`);
        console.log(`üîç Encontradas ${allOptions.length} alternativas`);
        
        // Remove classes anteriores
        allOptions.forEach(option => {
          option.classList.remove('correct', 'incorrect', 'selected');
        });
        if (commentDiv) commentDiv.classList.remove('show');

        let correctAnswerValue = null;
        let questionComment = null;

        // Verifica se √© pergunta est√°tica ou din√¢mica
        const isStatic = card.id && card.id.startsWith('question-');
        if (isStatic) {
          // Pergunta est√°tica - busca nos dados originais
          const questionData = questions.find(q => q.question.trim() === questionText);
          if (questionData) {
            correctAnswerValue = questionData.correctAnswer.trim();
            questionComment = questionData.comment;
          }
        } else {
          // Pergunta din√¢mica - busca pela op√ß√£o marcada como correta
          const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
          if (correctOpt) {
            correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
            console.log(`‚úÖ Resposta correta encontrada: "${correctAnswerValue}"`);
          } else {
            console.log('‚ùå Nenhuma resposta correta encontrada para pergunta din√¢mica');
          }
          
          // Busca coment√°rio no pr√≥prio card ou no div comment
          const commentElement = card.querySelector('.comment');
          if (commentElement && commentElement.textContent.trim()) {
            questionComment = commentElement.textContent.trim();
          }
        }

        // Processa resposta do usu√°rio e aplica colora√ß√£o
        let userAnswer = null;
        if (userAnswerElement) {
          userAnswerElement.classList.add('selected');
          userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
          totalQuestionsAnswered++;
          totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

          console.log(`üë§ Resposta do usu√°rio: "${userAnswer}"`);
          console.log(`üéØ Resposta correta: "${correctAnswerValue}"`);

          // Verifica se a resposta est√° correta
          if (userAnswer === correctAnswerValue) {
            correctAnswersCount++;
            console.log(`‚úÖ Resposta correta!`);
          } else {
            hasErrors = true;
            errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
            console.log(`‚ùå Resposta incorreta para t√≥pico: ${questionTopic}`);
          }
        }

        // Aplica colora√ß√£o: SEMPRE marca a correta de verde, e a errada de vermelho se foi marcada
        allOptions.forEach(option => {
          const optionValue = option.dataset.value?.trim() || option.textContent.trim();
          
          // Marca a resposta correta de verde SEMPRE
          if (optionValue === correctAnswerValue) {
            option.classList.add('correct');
            console.log(`üü¢ Marcando como correta: "${optionValue}"`);
          }
          
          // Se o usu√°rio marcou uma resposta E ela est√° errada, marca de vermelho
          if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) {
            option.classList.add('incorrect');
            console.log(`üî¥ Marcando como incorreta: "${optionValue}"`);
          }
        });

        // Mostra coment√°rio se dispon√≠vel
        if (commentDiv && questionComment) {
          commentDiv.textContent = questionComment;
          commentDiv.classList.add('show');
        }
      });

      // Exibe resultados
      resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

      console.log('üìä Erros por t√≥pico:', errorCountByTopic);
      console.log('üìä Total por t√≥pico:', totalAnsweredQuestionsByTopic);

      // Gera diagn√≥stico de erros
      if (hasErrors) {
        for (const topic in errorCountByTopic) {
          const errors = errorCountByTopic[topic];
          const total = totalAnsweredQuestionsByTopic[topic] || 0;
          if (total > 0) {
            const percent = ((errors / total) * 100).toFixed(1);
            const li = document.createElement('li');
            li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes respondidas)`;
            topicsToReviewList.appendChild(li);
          }
        }
      } else {
        const li = document.createElement('li');
        li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
        topicsToReviewList.appendChild(li);
      }

      errorDiagnosisSection.style.display = 'block';
      generatedQuestionsSection.style.display = 'block';
      generateNewQuestionsBtn.style.display = 'block';
      scrollToDiagnosis();
    }

    function scrollToQuestion(index) {
      const questionCard = document.getElementById(`question-${index}`);
      if (questionCard) {
        questionCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function scrollToDiagnosis() {
        errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function scrollToGeneratedQuestions() {
        generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Event listener para sele√ß√£o de op√ß√µes (funciona para est√°ticas e din√¢micas)
    document.addEventListener("click", function (event) {
      const clickedElement = event.target;
      const optionElement = clickedElement.closest('.option');

      if (optionElement) {
          if (clickedElement.classList.contains("scissor-icon")) {
              event.stopPropagation();
              optionElement.classList.toggle("struck-through");
          }
          else {
              const parentCard = optionElement.closest('.card');
              const currentQuestionOptions = parentCard.querySelectorAll('.option');

              currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
              optionElement.classList.add("selected");
          }
      }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;

        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });

        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            newQuestionsContent.innerHTML = '';
            if (data && data.html) {
                console.log('üì• HTML recebido do Flask:', data.html);
                
                // Insere o HTML diretamente sem reconstru√ß√£o complexa
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                // Adiciona tesouras e ajusta formata√ß√£o apenas se necess√°rio
                newQuestionsContent.querySelectorAll('.card').forEach((card, cardIndex) => {
                    // Garante que o elemento de pergunta tenha a classe correta
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) {
                       questionElement.classList.add('question');
                    }

                    // Remove qualquer input de radio que possa existir e adiciona tesouras
                    card.querySelectorAll('label').forEach((label) => {
                        // Remove inputs de radio MAS preserva o atributo data-answer
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            // PRESERVA o atributo data-answer do input no label
                            if (radioInput.hasAttribute('data-answer')) {
                                label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            }
                            radioInput.remove();
                        }
                        
                        // Garante que tenha a classe option
                        if (!label.classList.contains('option')) {
                            label.classList.add('option');
                        }

                        // Garante que tenha data-value
                        if (!label.dataset.value) {
                            label.dataset.value = label.textContent.trim();
                        }

                        // Adiciona tesoura se n√£o existir
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) {
                                e.stopPropagation();
                                label.classList.toggle('struck-through');
                            };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });

                    console.log(`üè∑Ô∏è Card ${cardIndex}: data-topic = "${card.dataset.topic}"`);
                    
                    // Verifica se h√° op√ß√£o correta marcada
                    const correctOption = card.querySelector('label[data-answer="true"]');
                    if (correctOption) {
                        console.log(`‚úÖ Op√ß√£o correta encontrada: "${correctOption.dataset.value}"`);
                    } else {
                        console.log('‚ùå Nenhuma op√ß√£o correta encontrada');
                    }
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas para os t√≥picos selecionados.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);

        } catch (error) {
            console.error('Erro ao gerar novas perguntas:', error);
            newQuestionsContent.innerHTML = `<p>Erro ao carregar novas perguntas: ${error.message}. Por favor, tente novamente.</p>`;
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '‚ùå Erro na requisi√ß√£o: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    // Inicializa√ß√£o
    buildQuiz();
    errorDiagnosisSection.style.display = 'none';
    generatedQuestionsSection.style.display = 'none';
    generateNewQuestionsBtn.style.display = 'none';

    // Event listener para o bot√£o de verificar respostas
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
  </script>
</body>
<script src="navegacao.js"></script></html>
